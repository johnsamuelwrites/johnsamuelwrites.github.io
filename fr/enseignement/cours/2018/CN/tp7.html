<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Language" content="en"/>
    <link rel="shortcut icon" href="../.../../2017/DataMining/images/logo/favicon.png"/>
    <title>Chimie et Numérique: John Samuel</title>
    <style type="text/css">
    body{
      background-color: #FFFFFF;
    }
    #sidebar {
      position: fixed;
      background-color: #1B80CF;
      top: 0;
      left: 0;
      bottom: 0;
      width:25vw;
    }
    #sidebar .title {
      position:relative;
      text-align: center;
      line-height: 5vmax;
      font-size: 1.4vmax;
      font-family: 'Arial';
      margin-top: 30vh;
    }
    #sidebar .title a:link,
    #sidebar .title a:visited{
     color: #FFFFFF;
     text-decoration:none;
    }
    .subtitle {
      top: 50vh;
      text-align: center;
      line-height: 1.3vmax;
      font-family: 'Arial';
      font-size: 1.5vmax;
      color: #FFFFFF;
    }
    a:link, a:visited {
     color:#1B80CF;
    }
    .subtitle a:link,
    .subtitle a:visited{
     color: #FFFFFF;
     text-decoration:none;
    }
    .licence {
      position:fixed;
      text-align: right;
      bottom:0;
      right:0;
    }
    .home {
     position:fixed;
     text-align: left;
     font-family: 'Arial';
     color: #D3D3D3;
     z-index:100;
     width:100%;
     background-color:#FFFFFF;
     top:0px;
     margin-bottom:10px;
     padding-bottom:10px;
    }
    .codeexample {
      background-color:#eeeeee;
    }
    .home ul{
      margin: 0;
      padding: 0;
      text-align: left;
      list-style:none;
    }
    .home li{
     position: relative;
     float: left;
     padding-top:15px;
     margin-right: 1em;
     font-family: 'Arial';
    }
    .home li:hover {
      display:block;
    }
    .home a:link,
    .home a:visited{
     color: #D3D3D3;
    }
    .home li:hover a:link,
    .home li:hover a:visited{
      text-decoration:none;
      padding:15px;
      color:#FFFFFF;
      background-color: #1B80CF;
    }
    .content {
     line-height: 1.8vmax;
     font-size: 1.2vmax;
     font-family: 'Arial';
     margin-top: 15vh;
     width:90%;
    }
    .content h2, h3, h4{
     color:#1B80CF;
    }
    .content a:link,
    .content a:visited{
     color: #1B80CF;
    }
    .content h2::before,
    .content h3::before{
       display: block;
       content : " ";
       visibility:hidden;
       height:50px;
       margin-top:-50px;
       pointer-events: none;
       background-color:#FFFFFF;
    }
    .content a:link,
    .content a:visited{
     color:#1B80CF;
    }
    .content li {
      margin:5px;
    }
    .exercise {
     margin-left:2vw;
    }
    .exercise p{
     margin-left:1vw;
    }
    .exercise img{
     width:100%;
    }
    .content a:link,
    .content a:visited{
     color:#1B80CF;
    }
    .home a:link,
    .home a:visited{
     color: #D3D3D3;
    }
    .page {
      width:65vw;
      height:100%;
      margin-left:25vw;
      overflow: auto;
      padding: 0 1em;
    }
    img {
     max-width:100%;
     max-height:100%;
    }
    /* Using same Jupyter CSS
     */
    .highlight  { background: #f8f8f8; }
    .highlight .c { color: #408080; font-style: italic } /* Comment */
    .highlight .err { border: 1px solid #FF0000 } /* Error */
    .highlight .k { color: #008000; font-weight: bold } /* Keyword */
    .highlight .o { color: #666666 } /* Operator */
    .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
    .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
    .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
    .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
    .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
    .highlight .k { color: #008000; font-weight: bold } /* Keyword */
    .highlight .s2 { color: #BA2121 } /* Literal.String.Double */
    .highlight .s1 { color: #BA2121 } /* Literal.String.Single */
    .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
    .highlight .nb { color: #008000 } /* Name.Builtin */
    .highlight .mb { color: #666666 } /* Literal.Number.Bin */
    .highlight .mf { color: #666666 } /* Literal.Number.Float */
    .highlight .mh { color: #666666 } /* Literal.Number.Hex */
    .highlight .mi { color: #666666 } /* Literal.Number.Integer */
    .highlight .mo { color: #666666 } /* Literal.Number.Oct */
    @media (max-width: 640px), screen and (orientation: portrait) {
      body {
        max-width:100%;
        max-height:100%;
      }
      #sidebar {
        position: fixed;
        background-color: #1B80CF;
        top: 0;
        left: 0;
        bottom: 80vh;
        width:100vw;
      }
      #sidebar .title {
        text-align: center;
        position: fixed;
        margin-top: 6vh;
        left:0px;
        right:0px;
        line-height: 3.5vmax;
        font-size: 1.5vmax;
        font-family: 'Arial';
      }
      #sidebar .subtitle {
        text-align:center;
        top: 5vh;
        left:0px;
        right:0px;
        position: fixed;
        margin-top: 10vh;
        font-size: 1.5vmax;
      }
      #sidebar .title a:link,
      #sidebar .title a:visited{
        text-align:center;
        color:#FFFFFF;
      }
      #sidebar .subtitle a:link,
      #sidebar .subtitle a:visited{
        text-align:center;
        color:#FFFFFF;
      }
      .home{
        z-index:100;
        width:100%;
        background-color:#1B80CF;
        font-size:1.5vmax;
      }
      .home a:link,
      .home a:visited{
        text-decoration:none;
        color:#FFFFFF;
      }
      .content {
        line-height: 3.8vmax;
        font-size: 1.8vmax;
        font-family: 'Arial';
        margin-top:22vh;
      }
      .content a:link,
      .content a:visited{
        color:#1B80CF;
      }
      .page {
        top: 40vh;
        width:95%;
        margin-left:0vw;
      }
      .page img {
        max-width:100%;
        max-height:100%;
        border:0;
      }
    }

    </style>
  </head>
  <body vocab="http://schema.org/">
    <div id="sidebar">
     <div class="title">
      <h1><a href="./index.html">Travaux Pratiques: Chimie et Numérique</a></h1>
     </div>
     <div class="subtitle">
      <h3><a href="../../../../about.html">John Samuel</a></h3>
     </div>
    </div>
    <div class="licence"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="../../../../../images/license.png"/></a>
    </div>
    <div class="page">
      <div class="home">
       <ul typeof="BreadcrumbList">
        <li property="itemListElement" typeof="ListItem">
          <a property="item" typeof="WebPage" href="../../../../index.html">
            <span property="name">Accueil</span>
          </a>
        </li>
        <li property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="index.html">
          <span property="name">Chimie et Numérique</span>
         </a>
        </li>
        <li property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="../../../index.html">
          <span property="name">Enseignement</span>
         </a>
        </li>
       </ul>
      </div>
      <div class="content">
        <h3>Objectifs</h3>
        <ul>
          <li>Work on <a href="https://en.wikipedia.org/wiki/Decision_tree">decision trees</a> and <a href="https://en.wikipedia.org/wiki/Random_forest">random forests</a>.</li>
          <li>Work on <a href="https://en.wikipedia.org/wiki/Online_machine_learning">online machine training</a>.</li>
          <li>Work on <a href="http://scikit-learn.org/stable/modules/neural_networks_supervised.html">neural network models</a> using <a href="https://www.tensorflow.org/">Tensorflow</a>.</li>
          <li>Finish work on the <a href="https://en.wikipedia.org/wiki/Recommender_system">recommender system</a> and writing of project report.</li>
        </ul>
        <h3>Evaluation</h3>
        <p>Chaque exercice a un niveau de difficulté. Les exercices faciles et de difficulté moyenne vous aident pour comprendre les fondamentaux. Il est recommandé de finir ces exercices avant de commencer les exercices difficiles. Le niveau de difficulté de l'exercice:</p>
        <ol>
          <li><span style="color:red">&#9733;</span>: Facile</li>
          <li><span style="color:red">&#9733;&#9733;</span>: Moyen</li>
          <li><span style="color:red">&#9733;&#9733;&#9733;</span>: Difficile</li>
        </ol>
        <h4>Installation</h4>
        <div class="exercise">
          <p>Please refer <a href="./installation.html">installation</a> page. In this practical session, we will also use graphviz and pydotplus.</p>
        </div>
        <h4>Exercice 7.1 <span style="color:red">&#9733;</span></h4>
        <div class="exercise">
          <p>In this practical session, we start experimenting with decision trees. We will first build a Decision Tree Classifier using a very simple example. Like the classifiers we have seen before, we will first try to fit our data and then predict a class for a previously unseen value.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="n">dtc</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
            </code>
          </p>
          <p>Our next goal is to visualize the decision tree. Look at the following code and see how we have given names to the two columns of the above data. We also gave name names to the <i>result</i> data entries, calling them <i>class1</i> and <i>class2</i>.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">import</span> <span class="nn">pydotplus</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<span class="n">dot_data</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">dtc</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;column1&#39;</span><span class="p">,</span> <span class="s1">&#39;column2&#39;</span><span class="p">],</span>
                                <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                <span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;class1&#39;</span><span class="p">,</span> <span class="s1">&#39;class2&#39;</span><span class="p">]</span>
                                <span class="p">)</span> 
<span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>
<span class="n">pydot_graph</span> <span class="o">=</span> <span class="n">pydotplus</span><span class="o">.</span><span class="n">graph_from_dot_data</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pydot_graph</span><span class="o">.</span><span class="n">create_png</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
            </code>
          </p>
          <p>Now, let's take some realistic example. In the following code, we consider 13 photographs marked by a user as 'Favorite' and 'NotFavorite'. For every photograph: we have four information: color, tag, size (medium sized, thumbnail etc.) and mode in which the photograph was taken (portrait or landscape). We will build a Decision Tree Classifier with this data. We will then predict whether our user will like a photograph of nature which has a predominant color red, of thumbnail size and taken in portrait mode.</p>
          <p>In the following code, we display two values. We predict whether the user will favorite the photograph or not. We also display the importance of each of the features: color, tag, size and mode.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">LabelEncoder</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span><span class="s1">&#39;landscape&#39;</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span>
          <span class="p">]</span>


<span class="c1">#creating dataframes</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">])</span>
<span class="n">resultframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#generating numerical labels</span>
<span class="n">le1</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>

<span class="n">le2</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>

<span class="n">le3</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>

<span class="n">le4</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le4</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

<span class="n">le5</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le5</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#Use of decision tree classifiers</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">resultframe</span><span class="p">)</span>

<span class="c1">#prediction</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span>
    <span class="p">[</span><span class="n">le1</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;red&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">le2</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;nature&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span>
     <span class="n">le3</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;thumbnail&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">le4</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;portrait&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">le5</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dtc</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)</span>
</pre></div>
            </code>
          </p>
          <p>What are your observations?</p>
          <p>Our next goal is to visualize the above decision tree. Test the code below. It's similar to the code we tested before. Take a look at the classes and the features.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">LabelEncoder</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">import</span> <span class="nn">pydotplus</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span><span class="s1">&#39;landscape&#39;</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span>
          <span class="p">]</span>


<span class="c1">#creating dataframes</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">])</span>
<span class="n">resultframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#generating numerical labels</span>
<span class="n">le1</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>

<span class="n">le2</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>

<span class="n">le3</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>

<span class="n">le4</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le4</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

<span class="n">le5</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le5</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#Use of decision tree classifiers</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">resultframe</span><span class="p">)</span>

<span class="n">dot_data</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">dtc</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">feature_names</span><span class="o">=</span><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                     <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                     <span class="n">class_names</span> <span class="o">=</span>
                     <span class="n">le5</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
                       <span class="n">resultframe</span><span class="o">.</span><span class="n">favorite</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
                    <span class="p">)</span> 
<span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span> 
 
<span class="n">pydot_graph</span> <span class="o">=</span> <span class="n">pydotplus</span><span class="o">.</span><span class="n">graph_from_dot_data</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pydot_graph</span><span class="o">.</span><span class="n">create_png</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
            </code>
          </p>
          <p>What if we had a possibility of multiple decision trees? Let's predict using a Random Forest Classifier (can be seen as a collection of multiple decision trees). Check the predicted value as well as the importance of the different features. Note that we are asking to create 10 such estimators using a maximum depth of 2 for each of the estimator.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">LabelEncoder</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">import</span> <span class="nn">pydotplus</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span><span class="s1">&#39;landscape&#39;</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span>
          <span class="p">]</span>


<span class="c1">#creating dataframes</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">])</span>
<span class="n">resultframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#generating numerical labels</span>
<span class="n">le1</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>

<span class="n">le2</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>

<span class="n">le3</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>

<span class="n">le4</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le4</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

<span class="n">le5</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le5</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#Use of random forest classifier</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                             <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">resultframe</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="c1">#prediction</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span>
    <span class="p">[</span><span class="n">le1</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;red&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">le2</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;nature&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span>
     <span class="n">le3</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;thumbnail&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">le4</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;portrait&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">le5</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rfc</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)</span>
</pre></div>
            </code>
          </p>
          <p>Finally we visualize these estimators.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">LabelEncoder</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">import</span> <span class="nn">pydotplus</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span><span class="s1">&#39;landscape&#39;</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span>
          <span class="p">]</span>


<span class="c1">#creating dataframes</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">])</span>
<span class="n">resultframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#generating numerical labels</span>
<span class="n">le1</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>

<span class="n">le2</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>

<span class="n">le3</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>

<span class="n">le4</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le4</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

<span class="n">le5</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le5</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#Use of decision tree classifiers</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                             <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,)</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">resultframe</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">dot_data</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">rfc</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">feature_names</span><span class="o">=</span><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                   <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">class_names</span> <span class="o">=</span>
                    <span class="n">le5</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
                      <span class="n">resultframe</span><span class="o">.</span><span class="n">favorite</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
                   <span class="p">)</span> 
    <span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span> 
    <span class="n">pydot_graph</span> <span class="o">=</span> <span class="n">pydotplus</span><span class="o">.</span><span class="n">graph_from_dot_data</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pydot_graph</span><span class="o">.</span><span class="n">create_png</span><span class="p">())</span>
    <span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
            </code>
          </p>
        </div>
        <h4>Exercice 7.2 <span style="color:red">&#9733;</span></h4>
        <div class="exercise">
          <p>During our last <a href="./practicals3.html">practical session 3</a>, we split our data into two: training data and test data for creating models for prediction and we fed the complete training data to our classifier. However, in real life, we may have new data to train. Check the following code using perceptron and compare it with the code of exercise 3.3:</p>
          <p class="codeexample">
            <code>
              from sklearn import datasets, metrics<br/>
              from sklearn.linear_model import Perceptron<br/>
              import numpy as np<br/>
              import matplotlib.pyplot as plot<br/>
              <br/>
              digits = datasets.load_digits()<br/>
              training_size = int(digits.images.shape[0]/2)<br/>
              <br/>
              training_images = digits.images[0:training_size]<br/>
              training_images = training_images.reshape((training_images.shape[0], -1))<br/>
              <br/>
              training_target = digits.target[0:training_size]<br/>
              <br/>
              classifier = Perceptron(max_iter=1000)<br/>
              #training<br/>
              for i in range(training_size):<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;training_data = np.array(training_images[i])<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;training_data = training_data.reshape(1, -1)<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;classifier.partial_fit(training_data, [training_target[i]], classes=np.unique(digits.target))<br/>
              <br/>
              #prediction<br/>
              predict_images = digits.images[training_size+1:]<br/>
              actual_labels = digits.target[training_size+1:]<br/>
              predicted_labels = classifier.predict(predict_images.reshape((predict_images.shape[0], -1)))<br/>
              <br/>
              #classification report<br/>
              print(metrics.classification_report(actual_labels,predicted_labels))<br/>
            </code>
          </p>
          <p>This approach is called <a href="https://en.wikipedia.org/wiki/Online_machine_learning">online machine training</a> (or <a href="https://fr.wikipedia.org/wiki/Algorithme_d%27apprentissage_incr%C3%A9mental">algorithme d'apprentissage incrémental (fr)</a>). Did you get good precision? </p>
           <p>Your next question is to modify the above program and test online training with <b>MLPClassifier</b>.</p>
           <p>Try modifying (reducing and increasing) the training data size. What are your observations?</p>
        </div>
        <h4>Exercice 7.3 (Optional) <span style="color:red">&#9733;&#9733;</span></h4>
        <div class="exercise">
         <p>Your final exercise is to use <a href="https://www.tensorflow.org/">Tensorflow</a>. We will use a Deep Neural Network (DNN) classifier with two hidden layers. Before starting, please refer the <a href="./installation.html">installation</a> page for installing tensorflow.</p>
         <p>Recall that we have already used Multilayer perceptron (MLP), a subset of Deep Neural Network in our preceding practical session. We will first predict an image of a digit using <a href="https://www.tensorflow.org/api_docs/python/tf/contrib/learn/DNNClassifier">DNNClassifier</a>.</p>
         <p class="codeexample">
          <code>
              import tensorflow as tf<br/>
              from sklearn import datasets<br/>
              import matplotlib.pyplot as plot<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;<br/>
              digits = datasets.load_digits()<br/>
              training_size = int(digits.images.shape[0]/2)<br/>
              <br/>
              training_images = digits.images[0:training_size]<br/>
              training_images = training_images.reshape((training_images.shape[0], -1))<br/>
              <br/>
              training_target = digits.target[0:training_size]<br/>
              <br/>
              classifier = tf.contrib.learn.DNNClassifier(<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    feature_columns=[tf.contrib.layers.real_valued_column("", dtype=tf.float64)],<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 2  hidden layers of 50 nodes each<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    hidden_units=[50, 50],<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 10 classes: 0, 1, 2...9<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;     n_classes=10)<br/>
              <br/>
              #training<br/>
              classifier.fit(training_images, training_target, steps=100)<br/>
              <br/>
              #prediction<br/>
              predict_images = digits.images[training_size+1:]<br/>
              <br/>
              predict = classifier.predict(predict_images[16].reshape(1,-1))<br/>
              print(list(predict))<br/>
              plot.imshow(predict_images[16], cmap=plot.cm.gray_r)<br/>
              plot.show()<br/>
          </code>
         </p>
         <p>Did it work? Let's now try to get the accuracy of our model. Will it work for our entire test data?</p>
         <p class="codeexample">
          <code>
              import tensorflow as tf<br/>
              from sklearn import datasets<br/>
              import matplotlib.pyplot as plot<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;<br/>
              digits = datasets.load_digits()<br/>
              training_size = int(digits.images.shape[0]/2)<br/>
              <br/>
              training_images = digits.images[0:training_size]<br/>
              training_images = training_images.reshape((training_images.shape[0], -1))<br/>
              <br/>
              training_target = digits.target[0:training_size]<br/>
              <br/>
              classifier = tf.contrib.learn.DNNClassifier(<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    feature_columns=[tf.contrib.layers.real_valued_column("", dtype=tf.float64)],<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 2  hidden layers of 50 nodes each<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    hidden_units=[50, 50],<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 10 classes: 0, 1, 2...9<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;     n_classes=10)<br/>
              <br/>
              #training<br/>
              classifier.fit(training_images, training_target, steps=100)<br/>
              <br/>
              #prediction<br/>
              predict_images = digits.images[training_size+1:]<br/>
              actual_labels = digits.target[training_size+1:]<br/>
              evaluation = classifier.evaluate(x=predict_images.reshape((predict_images.shape[0], -1)), y=actual_labels)<br/>
              print(evaluation['accuracy'])<br/>
          </code>
         </p>
         <p>What is the accuracy that you got? Now change the number of neurons in each layer (currently it is set to 50 each). Also try to increase the number of hidden layers. Did your accuracy improve?</p>
        </div>
      </div>
    </div>
  </body>
</html>
