<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Language" content="en"/>
    <link rel="shortcut icon" href="../../images/logo/favicon.png"/>
    <title>Les fondamentaux des sciences du numérique pour les chimistes (2018-2019): Travaux pratiques 3: John Samuel</title>
    <style type="text/css">
    body{
      background-color: #FFFFFF;
    }
    #sidebar {
      position: fixed;
      background-color: #1B80CF;
      top: 0;
      left: 0;
      bottom: 0;
      width:25vw;
    }
    #sidebar .title {
      position:relative;
      text-align: center;
      line-height: 3.5vmax;
      font-size: 1.1vmax;
      font-family: 'Arial';
      margin-left:2vmax;
      margin-right:2vmax;
      margin-top: 27vh;
    }
    #sidebar .title a:link,
    #sidebar .title a:visited{
     color: #FFFFFF;
     text-decoration:none;
    }
    .subtitle {
      top: 50vh;
      text-align: center;
      line-height: 1.3vmax;
      font-family: 'Arial';
      font-size: 1vmax;
      color: #FFFFFF;
    }
    a:link, a:visited {
     color:#1B80CF;
    }
    .subtitle a:link,
    .subtitle a:visited{
     color: #FFFFFF;
     text-decoration:none;
    }
    .licence {
      position:fixed;
      text-align: right;
      bottom:0;
      right:0;
    }
    .home {
     position:fixed;
     text-align: left;
     font-family: 'Arial';
     color: #D3D3D3;
     z-index:100;
     width:100%;
     background-color:#FFFFFF;
     top:0px;
     margin-bottom:10px;
     padding-bottom:10px;
    }
    .codeexample {
      background-color:#eeeeee;
    }
    .home ul{
      margin: 0;
      padding: 0;
      text-align: left;
      list-style:none;
    }
    .home li{
     position: relative;
     float: left;
     padding-top:15px;
     margin-right: 1em;
     font-family: 'Arial';
    }
    .home li:hover {
      display:block;
    }
    .home a:link,
    .home a:visited{
     color: #D3D3D3;
    }
    .home li:hover a:link,
    .home li:hover a:visited{
      text-decoration:none;
      padding:15px;
      color:#FFFFFF;
      background-color: #1B80CF;
    }
    .content {
     line-height: 1.8vmax;
     font-size: 1.2vmax;
     font-family: 'Arial';
     margin-top: 15vh;
     width:90%;
    }
    .content h2, h3, h4{
     color:#1B80CF;
    }
    .content a:link,
    .content a:visited{
     color: #1B80CF;
    }
    .content h2::before,
    .content h3::before{
       display: block;
       content : " ";
       visibility:hidden;
       height:50px;
       margin-top:-50px;
       pointer-events: none;
       background-color:#FFFFFF;
    }
    .content a:link,
    .content a:visited{
     color: #1B80CF;
    }
    .content li {
      margin:5px;
    }
    .exercise {
     margin-left:2vw;
    }
    .exercise p{
     margin-left:1vw;
    }
    .exercise img{
     width:100%;
    }
    .content a:link,
    .content a:visited{
     color:#1B80CF;
    }
    .home a:link,
    .home a:visited{
     color: #D3D3D3;
    }
    .page {
      width:65vw;
      height:100%;
      margin-left:25vw;
      overflow: auto;
      padding: 0 1em;
    }
    img {
     max-width:100%;
     max-height:100%;
    }
    /* Using same Jupyter CSS
     */
    .highlight  { background: #f8f8f8; }
    .highlight .c { color: #408080; font-style: italic } /* Comment */
    .highlight .err { border: 1px solid #FF0000 } /* Error */
    .highlight .k { color: #008000; font-weight: bold } /* Keyword */
    .highlight .o { color: #666666 } /* Operator */
    .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
    .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
    .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
    .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
    .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
    .highlight .k { color: #008000; font-weight: bold } /* Keyword */
    .highlight .s2 { color: #BA2121 } /* Literal.String.Double */
    .highlight .s1 { color: #BA2121 } /* Literal.String.Single */
    .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
    .highlight .nb { color: #008000 } /* Name.Builtin */
    .highlight .mb { color: #666666 } /* Literal.Number.Bin */
    .highlight .mf { color: #666666 } /* Literal.Number.Float */
    .highlight .mh { color: #666666 } /* Literal.Number.Hex */
    .highlight .mi { color: #666666 } /* Literal.Number.Integer */
    .highlight .mo { color: #666666 } /* Literal.Number.Oct */
    @media (max-width: 640px), screen and (orientation: portrait) {
      body {
        max-width:100%;
        max-height:100%;
      }
      #sidebar {
        position: fixed;
        background-color: #1B80CF;
        top: 0;
        left: 0;
        bottom: 80vh;
        width:100vw;
      }
      #sidebar .title {
        text-align: center;
        position: fixed;
        margin-top: 6vh;
        left:0px;
        right:0px;
        line-height: 3.5vmax;
        font-size: 1.5vmax;
        font-family: 'Arial';
      }
      #sidebar .subtitle {
        text-align:center;
        top: 5vh;
        left:0px;
        right:0px;
        position: fixed;
        margin-top: 10vh;
        font-size: 1.5vmax;
      }
      #sidebar .title a:link,
      #sidebar .title a:visited{
        text-align:center;
        color:#FFFFFF;
      }
      #sidebar .subtitle a:link,
      #sidebar .subtitle a:visited{
        text-align:center;
        color:#FFFFFF;
      }
      .home{
        z-index:100;
        width:100%;
        background-color:#1B80CF;
        font-size:1.5vmax;
      }
      .home a:link,
      .home a:visited{
        text-decoration:none;
        color:#FFFFFF;
      }
      .content {
        line-height: 3.8vmax;
        font-size: 1.8vmax;
        font-family: 'Arial';
        margin-top:22vh;
      }
      .content a:link,
      .content a:visited{
        color:#1B80CF;
      }
      .page {
        top: 40vh;
        width:95%;
        margin-left:0vw;
      }
      .page img {
        max-width:100%;
        max-height:100%;
        border:0;
      }
    }
    @media print {
      .home {
         display:none;
       }
    }

    </style>
  </head>
  <body vocab="http://schema.org/">
    <div id="sidebar">
     <div class="title">
      <h1><a href="./index.html">Les fondamentaux des sciences du numérique pour les chimistes: Travaux Pratiques</a></h1>
     </div>
     <div class="subtitle">
      <h3><a href="../../../../apropos.html">John Samuel</a></h3>
     </div>
    </div>
    <div class="licence"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="./../../../../../images/license.png"/></a>
    </div>
    <div class="page">
      <div class="home">
       <ul typeof="BreadcrumbList">
        <li property="itemListElement" typeof="ListItem">
          <a property="item" typeof="WebPage" href="../../../../index.html">
            <span property="name">Accueil</span>
          </a>
        </li>
        <li property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="index.html">
          <span property="name">Chimie et Numérique</span>
         </a>
        </li>
        <li property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="../../../index.html">
          <span property="name">Enseignement</span>
         </a>
        </li>
       </ul>
      </div>
      <div class="content">
        <h3>Les fondamentaux des sciences du numérique pour les chimistes</h3>
        <h3>Objectifs</h3>
        <ul>
          <li>Analyse de données capteurs</li>
          <li>Partitionnement de données</li>
          <li>Trouver des couleurs dominantes dans une image</li>
          <li>Prévision</li>
          <li>Reconnaissance de l'écriture manuscrite</li>
        </ul>
        <h3>Evaluation</h3>
        <p>Chaque exercice a un niveau de difficulté.
           Les exercices faciles et de difficulté moyenne vous aident à comprendre les fondamentaux.
           Il est recommandé de finir ces exercices avant de commencer les exercices difficiles.
           Le niveau de difficulté de l'exercice et le nombre d'étoiles associées sont montrés par la suite:</p>
        <ol>
          <li><span style="color:red">&#9733;</span>: Facile</li>
          <li><span style="color:red">&#9733;&#9733;</span>: Moyen</li>
          <li><span style="color:red">&#9733;&#9733;&#9733;</span>: Difficile</li>
        </ol>
        <h4>Exercice 3.1 <span style="color:red">&#9733;</span></h4>
        <div class="exercise">
          <h5>1. Données capteurs</h5>
          <p>Copier ce fichier <a href="valeurs.json">valeurs.json</a> dans votre repertoire afin de faire l'analyse.
             On va commencer par la lecture d'un fichier JSON en utilisant la bibliothéque json.
             Ensuite, nous créerons en utilisant la méthode <i><span style="color:blue">json_normalize</span></i> de la bibliothéque pandas.
          </p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> pandas.io.json <span style="color:green">import</span> <span style="color:blue">json_normalize</span><br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">import</span> json<br/>
              <br/>
              <span style="color:grey"># lecture d'un fichier JSON</span><br/>
              data = <span style="color:blue">json.load</span>(open('valeurs.json'))<br/>
              <br/>
              <span style="color:grey"># création d'un DataFrame pandas</span><br/>
              dataframe = <span style="color:blue">json_normalize</span>(data["values"])<br/>
              print(dataframe)<br/>
            </code>
          </p>
          <p>Voyez le code au-dessous et vous rémarquerez que nous n'avons pas précisé le type de données. 
           Notre prochain objectif est d'afficher les types de données choisi par <span style="color:blue">json_normalize</span> pour chaque colonne.
          </p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> pandas.io.json <span style="color:green">import</span> <span style="color:blue">json_normalize</span><br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">import</span> json<br/>
              <br/>
              <span style="color:grey"># lecture d'un fichier JSON</span><br/>
              data = <span style="color:blue">json.load</span>(open('valeurs.json'))<br/>
              <br/>
              <span style="color:grey"># création d'un DataFrame pandas</span><br/>
              dataframe = <span style="color:blue">json_normalize</span>(data["values"])<br/>
              <br/>
              <span style="color:grey"># type de données</span><br/>
              print(dataframe.dtypes)<br/>
            </code>
          </p>
          <h5>2. Changement de type de données</h5>
          <p>Il est possible de changer le type de données de chaque colonne d'un DataFrame pandas.
             Pour le faire, nous utiliserons la méthode <i>astype</i>.
          </p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> pandas.io.json <span style="color:green">import</span> <span style="color:blue">json_normalize</span><br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">import</span> json<br/>
              <span style="color:green">import</span> datetime <br/>
              <br/>
              <span style="color:grey"># lecture d'un fichier JSON</span><br/>
              data = <span style="color:blue">json.load</span>(open('valeurs.json'))<br/>
              <br/>
              <span style="color:grey"># création d'un DataFrame pandas</span><br/>
              dataframe = <span style="color:blue">json_normalize</span>(data["values"])<br/>
              <br/>
              <span style="color:grey"># changement de type de données</span><br/>
              dataframe = <span style="color:blue">dataframe.astype</span>(dtype= {"humidity" : "float32", "lum" : "int32", <br/>
              &nbsp;&nbsp;"pression" : "int32", "temp" : "float32",<br/>
              &nbsp;&nbsp;"UV" : "int32", "date" : datetime.datetime})<br/>
              print(dataframe.dtypes)<br/>
            </code>
          </p>
          <h5>3. Visualisation de données</h5>
          <p>Vous pouvez passer un DataFrame comme un argument à la méthode <i>plot</i> afin de le visualiser.
         </p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> pandas.io.json <span style="color:green">import</span> <span style="color:blue">json_normalize</span><br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">import</span> json<br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <span style="color:green">import</span> datetime <br/>
              <br/>
              data = <span style="color:blue">json.load</span>(open('valeurs.json'))<br/>
              dataframe = <span style="color:blue">json_normalize</span>(data["values"])<br/>
              <br/>
              dataframe = <span style="color:blue">dataframe.astype</span>(dtype= {"humidity" : "float32", "lum" : "int32", <br/>
              &nbsp;&nbsp;"pression" : "int32", "temp" : "float32",<br/>
              &nbsp;&nbsp;"UV" : "int32", "date" : datetime.datetime})<br/>
              <br/>
              <span style="color:grey">#visualisation de données</span><br/>
              <span style="color:blue">plot.plot</span>(dataframe["date"], dataframe["humidity"])<br/>
              <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p>Modifiez le code au-dessus et comparez la différence en performance.
             Voyez bien comment nous utiliserons la méthode <i>plot</i> d'un DataFrame au lieu de la bibliothéque plot.
          </p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> pandas.io.json <span style="color:green">import</span> <span style="color:blue">json_normalize</span><br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">import</span> json <br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <span style="color:green">import</span> datetime<br/>
              <br/>
              data = <span style="color:blue">json.load</span>(open('valeurs.json')) <br/>
              dataframe = <span style="color:blue">json_normalize</span>(data["values"]) <br/>
              <br/>
              dataframe = <span style="color:blue">dataframe.astype</span>(dtype= {"humidity" : "float32", "lum" : "int32", <br/>
              &nbsp;&nbsp;"pression" : "int32", "temp" : "float32", "UV" : "int32", <br/>
              &nbsp;&nbsp;"date" : datetime.datetime}) <br/>
              <br/>
              <span style="color:grey">#visualisation de données</span><br/>
              plot.figure()<br/>
              <span style="color:blue">dataframe.plot</span>(x='date', y= 'humidity')<br/>
              <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p><b>Question 1</b>: En continuant avec le fichier valeurs.json, codez en Python en utilisant pandas afin d'avoir les résultats suivants:
          </p>
          <ul>
            <li>Tracez un graphique montrant la luminosité en fonction de temps</li>
            <li>Tracez un graphique montrant la pression en fonction de temps</li>
            <li>Tracez un graphique montrant la UV en fonction de temps</li>
            <li>Tracez un seul graphique montrant les valeurs UV, luminosité, humidité, pression et température contre en fonction de temps</li>
          </ul>
        </div>
        <h4>Exercice 3.2 <span style="color:red">&#9733;&#9733;</span></h4>
        <div class="exercise">
          <h5>1. Graphique nuage de points</h5>
          <p>Nous avons déjà vu une diagramme à barres lorsque deuxième exercice.
             Maintenant, nous verrons un graphique nuage de points.
             Voyez bien le code ci-dessous et regarder comment nous préciserons l'axe X et l'axe Y.
          </p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> pandas.io.json <span style="color:green">import</span> <span style="color:blue">json_normalize</span><br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">import</span> json <br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <span style="color:green">import</span> datetime<br/>
              <br/>
              data = <span style="color:blue">json.load</span>(open('valeurs.json')) <br/>
              dataframe = <span style="color:blue">json_normalize</span>(data["values"]) <br/>
              dataframe = <span style="color:blue">dataframe.astype</span>(dtype= {"humidity" : "float32", "lum" : "int32", <br/>
              &nbsp;&nbsp;"pression" : "int32", "temp" : "float32", "UV" : "int32", <br/>
              &nbsp;&nbsp;"date" : datetime.datetime}) <br/>
              plot.figure()<br/>
              <span style="color:blue">dataframe.plot</span>(x='lum', y= 'UV', kind="scatter")<br/>
              <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p>Une autre essaie avec différentes valeurs pour l'axe X et l'axe Y du graphique.</p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> pandas.io.json <span style="color:green">import</span> <span style="color:blue">json_normalize</span><br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">import</span> json <br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <span style="color:green">import</span> datetime<br/>
              <br/>
              data = <span style="color:blue">json.load</span>(open('valeurs.json')) <br/>
              dataframe = <span style="color:blue">json_normalize</span>(data["values"]) <br/>
              dataframe = <span style="color:blue">dataframe.astype</span>(dtype= {"humidity" : "float32", "lum" : "int32", <br/>
              &nbsp;&nbsp;"pression" : "int32", "temp" : "float32", "UV" : "int32", <br/>
              &nbsp;&nbsp;"date" : datetime.datetime}) <br/>
              plot.figure()<br/>
              <span style="color:blue">dataframe.plot</span>(x='temp', y= 'humidity', kind="scatter")<br/>
              <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p>Quelles sont vos observations?</p>
          <h5>2. Partitionnement de données</h5>
          <p>Notre prochain objectif est de partionner des donnés.
             Pour le faire, nous utiliserons la bibliothéque Scikit-learn (sklearn) et plus précisement, l'algorithme KMeans.
          </p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> pandas.io.json <span style="color:green">import</span> <span style="color:blue">json_normalize</span><br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">import</span> json <br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <span style="color:green">import</span> datetime<br/>
              <span style="color:green">from</span> sklearn.cluster <span style="color:green">import</span> KMeans<br/>
              <br/>
              <span style="color:grey"># lecture d'un fichier JSON et création d'un DataFrame pandas</span><br/>
              data = <span style="color:blue">json.load</span>(open('valeurs.json')) <br/>
              dataframe = <span style="color:blue">json_normalize</span>(data["values"]) <br/>
              dataframe = <span style="color:blue">dataframe.astype</span>(dtype= {"humidity" : "float32", "lum" : "int32", <br/>
              &nbsp;&nbsp;"pression" : "int32", "temp" : "float32", "UV" : "int32", <br/>
              &nbsp;&nbsp;"date" : datetime.datetime}) <br/>
              <br/>
              <span style="color:grey"># création de deux clusters</span><br/>
              clusters = KMeans(n_clusters = 2)<br/>
              <br/>
              <span style="color:grey"># utilisation de deux colonnes pour la création de clusters</span><br/>
              clusters.fit(<span style="color:blue">dataframe.loc</span>[:, ["temp","humidity"]])<br/>
              <br/>
              <span style="color:grey"># visualisation de clusters/partitions</span><br/>
              <span style="color:blue">dataframe.plot</span>(x='temp', y= 'humidity', kind="scatter")<br/>
              centroids = clusters.cluster_centers_<br/>
              <span style="color:blue">plot.scatter</span>(centroids[:, 0], centroids[:, 1], marker='x', color='r')<br/>
              <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p>Vous pouvez distinguer chaque partition en utilisant une différente couleur pour chaque partition.</p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> pandas.io.json <span style="color:green">import</span> <span style="color:blue">json_normalize</span><br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">import</span> json <br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <span style="color:green">import</span> datetime<br/>
              <span style="color:green">from</span> sklearn.cluster <span style="color:green">import</span> KMeans<br/>
              <br/>
              data = <span style="color:blue">json.load</span>(open('valeurs.json')) <br/>
              dataframe = <span style="color:blue">json_normalize</span>(data["values"]) <br/>
              dataframe = <span style="color:blue">dataframe.astype</span>(dtype= {"humidity" : "float32", "lum" : "int32", <br/>
              &nbsp;&nbsp;"pression" : "int32", "temp" : "float32", "UV" : "int32", <br/>
              &nbsp;&nbsp;"date" : datetime.datetime}) <br/>
              <br/>
              clusters = KMeans(n_clusters = 2)<br/>
              clusters.fit(<span style="color:blue">dataframe.loc</span>[:, ["temp","humidity"]])<br/>
              <br/>
              <span style="color:grey"># visualisation de clusters/partitions</span><br/>
              centroids = clusters.cluster_centers_<br/>
              <br/>
              <span style="color:grey"># choix de couleurs pour les différentes partitions</span><br/>
              color_list = ['b', 'g', 'y']<br/>
              colors = [color_list[i] for i in clusters.labels_]<br/>
              <br/>
              <span style="color:blue">plot.scatter</span>(dataframe["temp"], dataframe["humidity"], c=colors)<br/>
              <span style="color:blue">plot.scatter</span>(centroids[:, 0], centroids[:, 1], marker='x', c='r')<br/>
              <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p>Voici le code qui créer deux partitions en utilisant les colonnes temp (tepérature) et la humidité (humidity)</p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> pandas.io.json <span style="color:green">import</span> <span style="color:blue">json_normalize</span><br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">import</span> json <br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <span style="color:green">import</span> datetime<br/>
              <span style="color:green">from</span> sklearn.cluster <span style="color:green">import</span> KMeans<br/>
              <br/>
              data = <span style="color:blue">json.load</span>(open('valeurs.json')) <br/>
              dataframe = <span style="color:blue">json_normalize</span>(data["values"]) <br/>
              dataframe = <span style="color:blue">dataframe.astype</span>(dtype= {"humidity" : "float32", "lum" : "int32", <br/>
              &nbsp;&nbsp;"pression" : "int32", "temp" : "float32", "UV" : "int32", <br/>
              &nbsp;&nbsp;"date" : datetime.datetime}) <br/>
              <br/>
              clusters = KMeans(n_clusters = 2)<br/>
              clusters.fit(<span style="color:blue">dataframe.loc</span>[:, ["temp","humidity"]])<br/>
              centroids = clusters.cluster_centers_<br/>
              color_list = ['b', 'g', 'y']<br/>
              colors = [color_list[i] for i in clusters.labels_]<br/>
              <br/>
              <span style="color:blue">plot.scatter</span>(dataframe["temp"], dataframe["humidity"], c=colors)<br/>
              <span style="color:blue">plot.scatter</span>(centroids[:, 0], centroids[:, 1], marker='x', c='r')<br/>
              <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p><b>Question 2</b>: Modifiez le code au-dessus afin d'avoir 3 partitions. Et puis 4 partitions.</p>
        </div>
        <h4>Exercice 3.3 <span style="color:red">&#9733;&#9733;</span></h4>
        <div class="exercise">
          <h5>1. Trouver des couleurs dominantes dans une image</h5>
          <p>Copiez le fichier <a href="../../../../../en/teaching/courses/2017/DataMining/images/flower.jpg">flower.jpg</a> dans votre repertoire afin de trouver des couleurs dominantes.
             Voyez le code ci-dessous qui sort les couleurs prédominantes du image.
             Nous testerons le code du 2 à 12 partitions en utilisant l'algorithme KMeans.
          </p>
          <p class="codeexample">
            <code>
             <span style="color:green">from</span> PIL <span style="color:green">import</span> Image<br/>
             <span style="color:green">import</span> numpy<br/>
             <span style="color:green">import</span> math<br/>
             <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
             <span style="color:green">from</span> sklearn.cluster <span style="color:green">import</span> KMeans<br/>
             <br/>
             imgfile = Image.open("flower.jpg")<br/>
             numarray = numpy.array(imgfile.getdata(), numpy.uint8)<br/>
             <br/>
             X = []<br/>
             Y = []<br/>
             <br/>
             fig, axes = plot.subplots(nrows=5, ncols=2, figsize=(20,25))<br/>
             <br/>
             xaxis = 0<br/>
             yaxis = 0<br/>
             for x in range(2, 12):<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;cluster_count = x <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;clusters = KMeans(n_clusters = cluster_count)<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;clusters.fit(numarray)<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;npbins = numpy.arange(0, cluster_count + 1)<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;histogram = numpy.histogram(clusters.labels_, bins=npbins)<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;labels = numpy.unique(clusters.labels_)<br/>
             <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;barlist = axes[xaxis, yaxis].bar(labels, histogram[0])<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;if(yaxis == 0):<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  yaxis = 1<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;else:<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  xaxis = xaxis + 1<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  yaxis = 0<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;for i in range(cluster_count):<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  barlist[i].set_color('#%02x%02x%02x' % (math.ceil(clusters.cluster_centers_[i][0]),<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      math.ceil(clusters.cluster_centers_[i][1]), math.ceil(clusters.cluster_centers_[i][2])))<br/>
             <br/>
             <br/>
             <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <h5>2. Amélioration de performance.</h5>
          <p>Ci-dessous, nous testerons le code avec un algorithme appelé MiniBatchKMeans, qui est plus performant à comparer à KMeans.
             MiniBatchKMeans n'utilise pas toutes les données du image pour la création des partitions, mais qu'une partie. 
          </p>
          <p class="codeexample">
            <code>
             <span style="color:green">from</span> PIL <span style="color:green">import</span> Image<br/>
             <span style="color:green">import</span> numpy<br/>
             <span style="color:green">import</span> math<br/>
             <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
             <span style="color:green">from</span> sklearn.cluster <span style="color:green">import</span> MiniBatchKMeans<br/>
             <br/>
             imgfile = Image.open("flower.jpg")<br/>
             numarray = numpy.array(imgfile.getdata(), numpy.uint8)<br/>
             <br/>
             X = []<br/>
             Y = []<br/>
             <br/>
             fig, axes = plot.subplots(nrows=5, ncols=2, figsize=(20,25))<br/>
             <br/>
             xaxis = 0<br/>
             yaxis = 0<br/>
             for x in range(2, 12):<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;cluster_count = x <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;clusters = MiniBatchKMeans(n_clusters = cluster_count)<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;clusters.fit(numarray)<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;npbins = numpy.arange(0, cluster_count + 1)<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;histogram = numpy.histogram(clusters.labels_, bins=npbins)<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;labels = numpy.unique(clusters.labels_)<br/>
             <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;barlist = axes[xaxis, yaxis].bar(labels, histogram[0])<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;if(yaxis == 0):<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  yaxis = 1<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;else:<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  xaxis = xaxis + 1<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  yaxis = 0<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;for i in range(cluster_count):<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  barlist[i].set_color('#%02x%02x%02x' % (math.ceil(clusters.cluster_centers_[i][0]),<br/>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      math.ceil(clusters.cluster_centers_[i][1]), math.ceil(clusters.cluster_centers_[i][2])))<br/>
             <br/>
             <br/>
             <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p><b>Question 3</b>: Modifiez le code au-dessus afin de trouver 15 couleurs dominantes en utilisant KMeans et MiniBatchKMeans. Comparez la performance.
          </p>
        </div>
        <h4>Exercice 3.4 <span style="color:red">&#9733;&#9733;&#9733;</span></h4>
        <div class="exercise">
          <h5>1. Prévision de population</h5>
          <p>Copier ce fichier <a href="population.csv">population.csv</a> dans votre repertoire afin de faire l'analyse.</p>
          <p class="codeexample">
            <code>
              <span style="color:green">import</span> numpy <span style="color:green">as</span> np<br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">from</span> sklearn.linear_model <span style="color:green">import</span> LinearRegression<br/>
              <span style="color:green">from</span> sklearn.preprocessing <span style="color:green">import</span> PolynomialFeatures<br/>
              dataset = np.loadtxt("population.csv", dtype={'names': ('year', 'population'), 'formats': ('i4', 'i')},<br/>
                  skiprows=1, delimiter=",", encoding="UTF-8")<br/>
              <br/>
              dataframe = pd.DataFrame(dataset)<br/>
              <span style="color:blue">plot.scatter</span>(x=dataframe['year'], y=dataframe['population'])<br/>
            </code>
          </p>
          <p>On va utiliser LinearRegression.</p>
          <p class="codeexample">
            <code>
              <span style="color:green">import</span> numpy <span style="color:green">as</span> np<br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <span style="color:green">import</span> pandas <span style="color:green">as</span> pd<br/>
              <span style="color:green">from</span> sklearn.linear_model <span style="color:green">import</span> LinearRegression<br/>
              <span style="color:green">from</span> sklearn.preprocessing <span style="color:green">import</span> PolynomialFeatures<br/>
              dataset = np.loadtxt("population.csv", dtype={'names': ('year', 'population'), 'formats': ('i4', 'i')},<br/>
                  skiprows=1, delimiter=",", encoding="UTF-8")<br/>
              <br/>
              dataframe = pd.DataFrame(dataset)<br/>
              <span style="color:grey">#training data</span><br/>
              <br/>
              x_train = df['year'][:40].values.reshape(-1, 1)<br/>
              y_train = df['population'][:40].values.reshape(-1, 1)<br/>
              <br/>
              pf = PolynomialFeatures(degree=1)<br/>
              x_poly = pf.fit_transform(x_train)<br/>
              <br/>
              <span style="color:grey">#apprentissage</span><br/>
              lr = LinearRegression()<br/>
              lr.fit(x_poly, y_train)<br/>
              <br/>
              <span style="color:grey">#affichage de coefficients</span><br/>
              print(lr.intercept_, lr.coef_)<br/>
              <br/>
              <span style="color:grey">#prediction</span><br/>
              x_predict = x_train = df['year'][41:].values.reshape(-1, 1)<br/>
              y_actual = df['population'][41:].values.reshape(-1, 1)<br/>
              y_predict = lr.predict(pf.fit_transform(x_predict))<br/>
              <br/>
              <span style="color:grey"># visualisation de données</span><br/>
              <span style="color:blue">plot.scatter</span>(x_predict, y_actual)<br/>
              <span style="color:blue">plot.plot</span>(x_predict, y_predict, color='red', linewidth=2)<br/>
              <span style="color:blue">plot.show</span>()<br/>
            </code>
            <p>Modifiez le code au-dessus en utilisant des PolynomialFeatures de différents degrés (2, 3, 4). Tracez les différents graphiques.</p>
          </p>
        </div>
        <h4>Exercice 3.5 <span style="color:red">&#9733;&#9733;&#9733;</span></h4>
        <div class="exercise">
          <h5>1. Reconnaissance de l'écriture manuscrite</h5>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> sklearn <span style="color:green">import</span> datasets, metrics<br/>
              <span style="color:green">from</span> sklearn.linear_model <span style="color:green">import</span> Perceptron<br/>
              <span style="color:green">import</span> numpy <span style="color:green">as</span> np<br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <br/>
              digits = datasets.load_digits()<br/>
              plot.imshow(digits.images[0], cmap=plot.cm.gray_r)<br/>
              <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p>Finalement, nous utiliserons une neuronne artificielle appelée Perceptron.
             Notre prochain objectif est d'utiliser un perceptron pour la réconnaissance de l'écriture.
             Mais, avant de l'utiliser, nous verrons le jeu de données: les images et l'entier associé.
          </p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> sklearn <span style="color:green">import</span> datasets, metrics<br/>
              <span style="color:green">from</span> sklearn.linear_model <span style="color:green">import</span> Perceptron<br/>
              <span style="color:green">import</span> numpy <span style="color:green">as</span> np<br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <br/>
              digits = datasets.load_digits()<br/>
              print(digits.target[0])<br/>
            </code>
          </p>
          <p>Voici le code pour l'affichage des images.</p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> sklearn <span style="color:green">import</span> datasets, metrics<br/>
              <span style="color:green">from</span> sklearn.linear_model <span style="color:green">import</span> Perceptron<br/>
              <span style="color:green">import</span> numpy <span style="color:green">as</span> np<br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <br/>
              digits = datasets.load_digits()<br/>
              for i in range(10):<br/>
              &nbsp;&nbsp;plot.imshow(digits.images[i], cmap=plot.cm.gray_r)<br/>
              &nbsp;&nbsp;<span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p>Finalement, nous testerons l'apprentissage en utilisant le perceptron.
             Nous séparerons les images et les étiquettes associées (les entiers) en deux parties: une partie pour faire l'apprentissage et la deuxième parties pour faire les testes.
             Il est important de noter que dans notre cas, toutes les images sont déjà étiquettées.
             Donc, nous pouvons comparer différentes modèles d'apprentissage. 
          </p>
          <p class="codeexample">
            <code>
              <span style="color:green">from</span> sklearn <span style="color:green">import</span> datasets, metrics<br/>
              <span style="color:green">from</span> sklearn.linear_model <span style="color:green">import</span> Perceptron<br/>
              <span style="color:green">import</span> numpy <span style="color:green">as</span> np<br/>
              <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
              <br/>
              digits = datasets.load_digits()<br/>
              <br/>
              training_images = digits.images[:int(digits.images.shape[0]/2)]<br/>
              training_images = training_images.reshape((training_images.shape[0], -1))<br/>
              <br/>
              training_target = digits.target[0:int(digits.target.shape[0]/2)]<br/>
              <br/>
              classifier = Perceptron(max_iter=1000)<br/>
              <span style="color:grey">#apprentissage</span><br/>
              classifier.fit(training_images, training_target)<br/>
              <br/>
              <span style="color:grey">#prévision</span><br/>
              predict_images = digits.images[int(digits.images.shape[0]/2)+1:]<br/>
              actual_labels = digits.target[int(digits.target.shape[0]/2)+1:]<br/>
              predicted_labels = classifier.predict(predict_images.reshape((predict_images.shape[0], -1)))<br/>
              <span style="color:grey"># voir une image prévisionnée</span><br/>
              predict_image = digits.images[int(digits.images.shape[0]/2)+2]<br/>
              print("Predicted value: ", classifier.predict(predict_image.reshape(1,-1)))<br/>
              <br/>
              plot.imshow(predict_image, cmap=plot.cm.gray_r)<br/>
              <span style="color:blue">plot.show</span>()<br/>
            </code>
          </p>
          <p class="codeexample">
            <code>
             <span style="color:green">from</span> sklearn <span style="color:green">import</span> datasets, metrics<br/>
             <span style="color:green">from</span> sklearn.linear_model <span style="color:green">import</span> Perceptron<br/>
             <span style="color:green">import</span> numpy <span style="color:green">as</span> np<br/>
             <span style="color:green">import</span> matplotlib.pyplot <span style="color:green">as</span> plot<br/>
             <br/>
             digits = datasets.load_digits()<br/>
             <br/>
             training_images = digits.images[:int(digits.images.shape[0]/2)]<br/>
             training_images = training_images.reshape((training_images.shape[0], -1))<br/>
             <br/>
             training_target = digits.target[0:int(digits.target.shape[0]/2)]<br/>
             <br/>
             classifier = Perceptron(max_iter=1000)<br/>
             <span style="color:grey"># apprentissage</span><br/>
             classifier.fit(training_images, training_target)<br/>
             <br/>
             <span style="color:grey">#prévision</span><br/>
             predict_images = digits.images[int(digits.images.shape[0]/2)+1:]<br/>
             actual_labels = digits.target[int(digits.target.shape[0]/2)+1:]<br/>
             predicted_labels = classifier.predict(predict_images.reshape((predict_images.shape[0], -1)))<br/>
             <br/>
             <span style="color:grey"># rapport de prévision</span><br/>
             print(metrics.classification_report(actual_labels,predicted_labels))<br/>
           </code>
          </p>
          <p><b>Question 4</b>: En continuant avec le fichier <a href="population.csv">population.csv</a>, codez en Python en utilisant Perceptron afin d'avoir les résultats suivants:
          </p>
          <ul>
            <li>Prevoir la population entre 2020 et 2050. Quelles sont vos observations? Quelle est votre solution?</li>
          </ul>
        </div>
      </div>
  </body>
</html>
