<!DOCTYPE html>
<html lang="fr">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="../images/logo/favicon.png" />
        <title>Recherche - John Samuel</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            :root {
                --color-base-bg: #fafbfc;
                --color-base-surface: #ffffff;
                --color-base-text: #1a202c;
                --color-base-text-muted: #4a5568;
                --color-accent-1: #87634B;
                --color-accent-2: #6B4E3D;
                --color-accent-3: #A07856;
                --color-accent-light: #F5F0EB;
                --color-shadow: rgba(135, 99, 75, 0.15);
                --color-border: rgba(135, 99, 75, 0.12);
                --color-hover: rgba(135, 99, 75, 0.08);
                --space-xs: 0.25rem;
                --space-sm: 0.5rem;
                --space-md: 1rem;
                --space-lg: 1.5rem;
                --space-xl: 2rem;
                --space-2xl: 3rem;
                --space-3xl: 4rem;
                --radius-sm: 6px;
                --radius-md: 12px;
                --radius-lg: 18px;
                --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.06);
                --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.06), 0 2px 4px rgba(0, 0, 0, 0.04);
                --shadow-lg: 0 10px 24px rgba(0, 0, 0, 0.08), 0 4px 12px rgba(0, 0, 0, 0.06);
                --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            }

            html {
                scroll-behavior: smooth;
            }

            body {
                font-family: var(--font-sans);
                font-size: 16px;
                line-height: 1.6;
                color: var(--color-base-text);
                background: linear-gradient(135deg, #fafbfc 0%, #f5f7fa 100%);
                min-height: 100vh;
            }

            /* Navigation */
            .navigation {
                position: sticky;
                top: 0;
                z-index: 1000;
                background: rgba(255, 255, 255, 0.85);
                -webkit-backdrop-filter: blur(16px) saturate(180%);
                backdrop-filter: blur(16px) saturate(180%);
                border-bottom: 1px solid rgba(135, 99, 75, 0.1);
                box-shadow: 0 4px 24px rgba(0, 0, 0, 0.04);
            }

            .nav-container {
                max-width: 1400px;
                margin: 0 auto;
                padding: 0 var(--space-xl);
                display: flex;
                align-items: center;
                justify-content: space-between;
                min-height: 70px;
                flex-wrap: wrap;
            }

            .nav-brand {
                font-size: 1.25rem;
                font-weight: 700;
                color: var(--color-accent-1);
                text-decoration: none;
                padding: var(--space-sm) var(--space-lg);
                background: linear-gradient(135deg, var(--color-accent-light) 0%, rgba(135, 99, 75, 0.1) 100%);
                border-radius: 9999px;
                letter-spacing: -0.02em;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .nav-brand:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 20px rgba(135, 99, 75, 0.2);
            }

            .nav-menu {
                display: flex;
                list-style: none;
                gap: var(--space-xs);
                align-items: center;
                flex-wrap: wrap;
            }

            .nav-menu a {
                text-decoration: none;
                color: var(--color-base-text);
                padding: var(--space-sm) var(--space-lg);
                border-radius: var(--radius-md);
                font-weight: 500;
                transition: all 0.3s ease;
                position: relative;
            }

            .nav-menu a:hover {
                color: var(--color-accent-1);
                background: var(--color-hover);
            }

            /* Main Content */
            main {
                max-width: 1200px;
                margin: 0 auto;
                padding: var(--space-3xl) var(--space-xl);
            }

            .search-header {
                text-align: center;
                margin-bottom: var(--space-3xl);
            }

            .search-header h1 {
                font-size: 2.5rem;
                font-weight: 700;
                color: var(--color-accent-2);
                margin-bottom: var(--space-md);
                letter-spacing: -0.02em;
            }

            .search-header p {
                color: var(--color-base-text-muted);
                font-size: 1.1rem;
            }

            /* Search Box */
            .search-container {
                margin-bottom: var(--space-3xl);
            }

            .search-box {
                position: relative;
                max-width: 700px;
                margin: 0 auto;
            }

            .search-input {
                width: 100%;
                padding: var(--space-lg) var(--space-xl);
                padding-left: 3.5rem;
                font-size: 1.1rem;
                border: 2px solid var(--color-border);
                border-radius: var(--radius-lg);
                background: var(--color-base-surface);
                color: var(--color-base-text);
                transition: all 0.3s ease;
                box-shadow: var(--shadow-sm);
            }

            .search-input:focus {
                outline: none;
                border-color: var(--color-accent-1);
                box-shadow: 0 0 0 3px rgba(135, 99, 75, 0.1), var(--shadow-md);
            }

            .search-icon {
                position: absolute;
                left: 1.2rem;
                top: 50%;
                transform: translateY(-50%);
                color: var(--color-base-text-muted);
                font-size: 1.2rem;
            }

            .search-filters {
                display: flex;
                gap: var(--space-md);
                justify-content: center;
                flex-wrap: wrap;
                margin-top: var(--space-lg);
            }

            .filter-btn {
                padding: var(--space-sm) var(--space-lg);
                border: 2px solid var(--color-border);
                background: var(--color-base-surface);
                color: var(--color-base-text);
                border-radius: var(--radius-md);
                cursor: pointer;
                font-weight: 500;
                transition: all 0.3s ease;
                font-size: 0.9rem;
            }

            .filter-btn:hover {
                border-color: var(--color-accent-1);
                background: var(--color-hover);
            }

            .filter-btn.active {
                background: var(--color-accent-1);
                color: white;
                border-color: var(--color-accent-1);
            }

            /* Results */
            .search-stats {
                text-align: center;
                color: var(--color-base-text-muted);
                margin-bottom: var(--space-xl);
                font-size: 1rem;
            }

            .results-container {
                display: grid;
                gap: var(--space-lg);
            }

            .result-card {
                background: var(--color-base-surface);
                border: 1px solid var(--color-border);
                border-radius: var(--radius-lg);
                padding: var(--space-xl);
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                box-shadow: var(--shadow-sm);
            }

            .result-card:hover {
                transform: translateY(-4px);
                box-shadow: var(--shadow-lg);
                border-color: var(--color-accent-1);
            }

            .result-category {
                display: inline-block;
                padding: var(--space-xs) var(--space-md);
                background: var(--color-accent-light);
                color: var(--color-accent-2);
                border-radius: var(--radius-sm);
                font-size: 0.85rem;
                font-weight: 600;
                margin-bottom: var(--space-sm);
                text-transform: capitalize;
            }

            .result-title {
                font-size: 1.4rem;
                font-weight: 600;
                color: var(--color-accent-2);
                margin-bottom: var(--space-sm);
            }

            .result-title a {
                color: inherit;
                text-decoration: none;
                transition: color 0.3s ease;
            }

            .result-title a:hover {
                color: var(--color-accent-1);
            }

            .result-excerpt {
                color: var(--color-base-text-muted);
                line-height: 1.7;
                margin-bottom: var(--space-md);
            }

            .result-excerpt mark {
                background: rgba(135, 99, 75, 0.2);
                color: var(--color-accent-2);
                padding: 0.1rem 0.2rem;
                border-radius: 2px;
                font-weight: 500;
            }

            .result-url {
                font-size: 0.9rem;
                color: var(--color-accent-1);
                text-decoration: none;
                display: inline-flex;
                align-items: center;
                gap: 0.3rem;
            }

            .result-url:hover {
                text-decoration: underline;
            }

            .no-results {
                text-align: center;
                padding: var(--space-3xl);
                color: var(--color-base-text-muted);
            }

            .no-results-icon {
                font-size: 4rem;
                margin-bottom: var(--space-lg);
                opacity: 0.3;
            }

            .no-results h2 {
                font-size: 1.5rem;
                color: var(--color-base-text);
                margin-bottom: var(--space-sm);
            }

            .loading {
                text-align: center;
                padding: var(--space-3xl);
                color: var(--color-base-text-muted);
            }

            .spinner {
                display: inline-block;
                width: 40px;
                height: 40px;
                border: 4px solid var(--color-border);
                border-top-color: var(--color-accent-1);
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }

            @keyframes spin {
                to {
                    transform: rotate(360deg);
                }
            }

            /* Responsive */
            @media (max-width: 768px) {
                .search-header h1 {
                    font-size: 2rem;
                }

                .search-input {
                    font-size: 1rem;
                    padding: var(--space-md) var(--space-lg);
                    padding-left: 3rem;
                }

                .result-card {
                    padding: var(--space-lg);
                }

                .result-title {
                    font-size: 1.2rem;
                }
            }
        </style>
    </head>

    <body>
        <!-- Navigation -->
        <nav class="navigation" role="navigation">
            <div class="nav-container">
                <a href="./index.html" class="nav-brand">John Samuel</a>
                <ul class="nav-menu">
                    <li><a href="./index.html">Fran√ßais</a></li>
                </ul>
            </div>
        </nav>

        <!-- Main Content -->
        <main>
            <div class="search-header">
                <h1>Recherche</h1>
                <p>Rechercher dans tout le contenu de ce site web</p>
            </div>

            <div class="search-container">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="searchInput" class="search-input"
                        placeholder="Rechercher des sujets, articles, photos ou cours..." autocomplete="off" autofocus>
                </div>
                <div class="search-filters">
                    <button class="filter-btn active" data-category="all">Tout</button>
                    <button class="filter-btn" data-category="research">Recherche</button>
                    <button class="filter-btn" data-category="teaching">Enseignement</button>
                    <button class="filter-btn" data-category="writings">√âcrits</button>
                    <button class="filter-btn" data-category="linguistics">Linguistique</button>
                    <button class="filter-btn" data-category="photography">Photographie</button>
                    <button class="filter-btn" data-category="travel">Voyage</button>
                    <button class="filter-btn" data-category="blog">Blog</button>
                </div>
            </div>

            <div id="searchStats" class="search-stats"></div>
            <div id="resultsContainer" class="results-container"></div>
        </main>

        <script>
            // Simple client-side search implementation
            let searchData = [];
            let currentCategory = 'all';

            // Initialize search
            async function initSearch() {
                try {
                    const response = await fetch('./search-index.json');
                    if (response.ok) {
                        searchData = await response.json();
                    } else {
                        console.log('Search index not found.');
                        searchData = [];
                    }
                } catch (error) {
                    console.error('Error loading search index:', error);
                    searchData = [];
                }
            }

            // Search function
            function performSearch(query) {
                if (!query || query.length < 2) {
                    displayResults([]);
                    return;
                }

                const searchTerms = query.toLowerCase().split(/\s+/);

                const results = searchData.filter(item => {
                    if (currentCategory !== 'all' && item.category !== currentCategory) {
                        return false;
                    }

                    const searchText = `${item.title} ${item.content || ''} ${item.url}`.toLowerCase();
                    return searchTerms.every(term => searchText.includes(term));
                });

                results.sort((a, b) => {
                    const aTitle = a.title.toLowerCase();
                    const bTitle = b.title.toLowerCase();
                    const aScore = searchTerms.reduce((score, term) =>
                        score + (aTitle.includes(term) ? 10 : 1), 0);
                    const bScore = searchTerms.reduce((score, term) =>
                        score + (bTitle.includes(term) ? 10 : 1), 0);
                    return bScore - aScore;
                });

                displayResults(results, query);
            }

            // Display results
            function displayResults(results, query = '') {
                const container = document.getElementById('resultsContainer');
                const stats = document.getElementById('searchStats');

                if (!query) {
                    container.innerHTML = '';
                    stats.innerHTML = '';
                    return;
                }

                if (results.length === 0) {
                    stats.innerHTML = '';
                    container.innerHTML = `
                    <div class="no-results">
                        <div class="no-results-icon">üîç</div>
                        <h2>Aucun r√©sultat trouv√©</h2>
                        <p>Essayez diff√©rents mots-cl√©s ou supprimez les filtres</p>
                    </div>
                `;
                    return;
                }

                stats.innerHTML = `Trouv√© ${results.length} r√©sultat(s) pour "${query}"`;

                container.innerHTML = results.map(result => {
                    const excerpt = getExcerpt(result.content || result.title, query);
                    const categoryLabel = result.category || 'general';

                    return `
                    <div class="result-card">
                        <span class="result-category">${categoryLabel}</span>
                        <h2 class="result-title">
                            <a href="${result.url}">${highlightText(result.title, query)}</a>
                        </h2>
                        <p class="result-excerpt">${excerpt}</p>
                        <a href="${result.url}" class="result-url">${result.url} ‚Üí</a>
                    </div>
                `;
                }).join('');
            }

            // Highlight search terms
            function highlightText(text, query) {
                if (!query) return text;
                const terms = query.split(/\s+/);
                let highlighted = text;
                terms.forEach(term => {
                    const regex = new RegExp(`(${escapeRegex(term)})`, 'gi');
                    highlighted = highlighted.replace(regex, '<mark>$1</mark>');
                });
                return highlighted;
            }

            // Get excerpt with context
            function getExcerpt(text, query, length = 200) {
                if (!text) return '';

                const terms = query.toLowerCase().split(/\s+/);
                const textLower = text.toLowerCase();

                let position = -1;
                for (const term of terms) {
                    const pos = textLower.indexOf(term);
                    if (pos !== -1 && (position === -1 || pos < position)) {
                        position = pos;
                    }
                }

                if (position === -1) {
                    return highlightText(text.substring(0, length), query) + (text.length > length ? '...' : '');
                }

                const start = Math.max(0, position - 50);
                const end = Math.min(text.length, position + length);
                let excerpt = text.substring(start, end);

                if (start > 0) excerpt = '...' + excerpt;
                if (end < text.length) excerpt = excerpt + '...';

                return highlightText(excerpt, query);
            }

            // Escape regex special characters
            function escapeRegex(string) {
                return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            }

            // Event listeners
            document.getElementById('searchInput').addEventListener('input', (e) => {
                performSearch(e.target.value);
            });

            // Category filters
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentCategory = this.dataset.category;
                    performSearch(document.getElementById('searchInput').value);
                });
            });

            // Initialize on load and handle URL parameters
            async function init() {
                await initSearch();

                // Check for query parameter in URL
                const urlParams = new URLSearchParams(window.location.search);
                const query = urlParams.get('q');

                if (query) {
                    document.getElementById('searchInput').value = query;
                    performSearch(query);
                }
            }

            init();
        </script>
    </body>

</html>