<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Language" content="en"/>
    <link rel="shortcut icon" href="../.../../2017/DataMining/images/logo/favicon.png"/>
    <title>Data Mining (2019-2020): John Samuel</title>
    <style type="text/css">
    body{
      background-color: #FFFFFF;
    }
    #sidebar {
      position: fixed;
      background-color: #00363a;
      top: 0;
      left: 0;
      bottom: 0;
      width:25vw;
    }
    #sidebar .title {
      position:relative;
      text-align: center;
      line-height: 5vmax;
      font-size: 1.4vmax;
      font-family: 'Arial';
      margin-top: 30vh;
    }
    #sidebar .title a:link,
    #sidebar .title a:visited{
     color: #FFFFFF;
     text-decoration:none;
    }
    .subtitle {
      top: 50vh;
      text-align: center;
      line-height: 1.3vmax;
      font-family: 'Arial';
      font-size: 1.5vmax;
      color: #FFFFFF;
    }
    a:link, a:visited {
     color:#00363a;
    }
    .subtitle a:link,
    .subtitle a:visited{
     color: #FFFFFF;
     text-decoration:none;
    }
    .licence {
      position:fixed;
      text-align: right;
      bottom:0;
      right:0;
    }
    .home {
     position:fixed;
     text-align: left;
     font-family: 'Arial';
     color: #D3D3D3;
     z-index:100;
     width:100%;
     background-color:#FFFFFF;
     top:0px;
     margin-bottom:10px;
     padding-bottom:10px;
    }
    .codeexample {
      background-color:#eeeeee;
    }
    .home ul{
      margin: 0;
      padding: 0;
      text-align: left;
      list-style:none;
    }
    .home li{
     position: relative;
     float: left;
     padding-top:15px;
     margin-right: 1em;
     font-family: 'Arial';
    }
    .home li:hover {
      display:block;
    }
    .home a:link,
    .home a:visited{
     color: #D3D3D3;
    }
    .home li:hover a:link,
    .home li:hover a:visited{
      text-decoration:none;
      padding:15px;
      color:#FFFFFF;
      background-color: #00363a;
    }
    .content {
     line-height: 1.8vmax;
     font-size: 1.2vmax;
     font-family: 'Arial';
     margin-top: 15vh;
     width:90%;
    }
    .content h2, h3, h4{
     color:#00363a;
    }
    .content a:link,
    .content a:visited{
     color: #00363a;
    }
    .content h2::before,
    .content h3::before{
       display: block;
       content : " ";
       visibility:hidden;
       height:50px;
       margin-top:-50px;
       pointer-events: none;
       background-color:#FFFFFF;
    }
    .content a:link,
    .content a:visited{
     color:#00363a;
    }
    .content li {
      margin:5px;
    }
    .exercise {
     margin-left:2vw;
    }
    .exercise p{
     margin-left:1vw;
    }
    .exercise img{
     width:100%;
    }
    .content a:link,
    .content a:visited{
     color:#00363a;
    }
    .home a:link,
    .home a:visited{
     color: #D3D3D3;
    }
    .page {
      width:65vw;
      height:100%;
      margin-left:25vw;
      overflow: auto;
      padding: 0 1em;
    }
    img {
     max-width:100%;
     max-height:100%;
    }
    /* Using same Jupyter CSS
     */
    .highlight  { background: #f8f8f8; }
    .highlight .c { color: #408080; font-style: italic } /* Comment */
    .highlight .err { border: 1px solid #FF0000 } /* Error */
    .highlight .k { color: #008000; font-weight: bold } /* Keyword */
    .highlight .o { color: #666666 } /* Operator */
    .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
    .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
    .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
    .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
    .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
    .highlight .k { color: #008000; font-weight: bold } /* Keyword */
    .highlight .s2 { color: #BA2121 } /* Literal.String.Double */
    .highlight .s1 { color: #BA2121 } /* Literal.String.Single */
    .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
    .highlight .nb { color: #008000 } /* Name.Builtin */
    .highlight .mb { color: #666666 } /* Literal.Number.Bin */
    .highlight .mf { color: #666666 } /* Literal.Number.Float */
    .highlight .mh { color: #666666 } /* Literal.Number.Hex */
    .highlight .mi { color: #666666 } /* Literal.Number.Integer */
    .highlight .mo { color: #666666 } /* Literal.Number.Oct */
    @media (max-width: 640px), screen and (orientation: portrait) {
      body {
        max-width:100%;
        max-height:100%;
      }
    }
    @media print {
      #sidebar {
        width:100%;
        top:0;
        position:relative;
        padding-bottom:3vh;
      }
      #sidebar .title {
        margin-top:0;
      }
      .home {
        display:none;
      }
      .page {
        margin-left:5vw;
        width:90%;
      }
    }
    </style>
  </head>
  <body vocab="http://schema.org/">
    <div id="sidebar">
     <div class="title">
      <h1><a href="./index.html">Practicals: Data Mining</a></h1>
     </div>
     <div class="subtitle">
      <h3><a href="../../../../about.html">John Samuel</a></h3>
     </div>
    </div>
    <div class="licence"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="../../../../../images/license.png"/></a>
    </div>
    <div class="page">
      <div class="home">
       <ul typeof="BreadcrumbList">
        <li property="itemListElement" typeof="ListItem">
          <a property="item" typeof="WebPage" href="../../../../index.html">
            <span property="name">Home</span>
          </a>
        </li>
        <li property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="index.html">
          <span property="name">Data Mining</span>
         </a>
        </li>
        <li property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="../../../index.html">
          <span property="name">Teaching</span>
         </a>
        </li>
       </ul>
      </div>
      <div class="content">
        <h3>Goals</h3>
        <ol>
          <li>Continue working with <a href="http://scikit-learn.org/stable/modules/clustering.html">clustering</a> and <a href="http://scikit-learn.org/stable/modules/svm.html">classification</a> algorithms</li>
          <li>Work on <a href="http://scikit-learn.org/stable/modules/linear_model.html">linear regression models</a></li>
          <li>Start working on <a href="http://scikit-learn.org/stable/modules/neural_networks_supervised.html">neural network models</a> including single and multilayered perceptrons.</li>
          <li>Work on <a href="https://en.wikipedia.org/wiki/Decision_tree">decision trees</a> and <a href="https://en.wikipedia.org/wiki/Random_forest">random forests</a>.</li>
          <li>Work on <a href="https://en.wikipedia.org/wiki/Online_machine_learning">online machine training</a>.</li>
          <li>Work on <a href="http://scikit-learn.org/stable/modules/neural_networks_supervised.html">neural network models</a> using <a href="https://www.tensorflow.org/">Tensorflow</a>.</li>
          <li>Continue working on the <a href="https://en.wikipedia.org/wiki/Recommender_system">recommender system</a></li>
        </ol>
        <h3>Scoring</h3>
        <p>Every exercise has an associated difficulty level. Easy and medium-difficult exercises help you understand the fundamentals and give you ideas to work on difficult exercises. It is highly recommended that you finish easy and medium-difficult exercises to have a good score. Given below is the difficulty scale that will be marked for every exercise: </p>
        <ol>
          <li><span style="color:red">&#9733;</span>: Easy</li>
          <li><span style="color:red">&#9733;&#9733;</span>: Medium</li>
          <li><span style="color:red">&#9733;&#9733;&#9733;</span>: Difficult</li>
        </ol>
        <h3>Guidelines</h3>
        <ol>
          <li>To get complete guidance from the mentors, it is highly recommended that you work on today's practical session and not on the preceding ones.</li>
          <li>Make sure that you rename your submission properly and correctly. Double-check your submission.</li>
          <li>Please check the <a href="./references.html">references</a>.</li>
          <li>There are several ways to achieve a task. Hence there are many possible solutions. But try to make maximum use of the libraries that have been suggested to you for your exercises.</li>
        </ol>
        <h4>Installation</h4>
        <div class="exercise">
        </div>
        <h4>Exercise 3.1 <span style="color:red">&#9733;</span></h4>
        <div class="exercise">
         <p>We will now work with <b>linear regression</b> (refer <a href="http://scikit-learn.org/stable/modules/linear_model.html#ordinary-least-squares">here</a>). </p>
         <p>Let's see some simple programs. In the following data, where we have some sample data for the equation: <i>y = x</i>. We will first train our Linear Regression model with a very small subset and test whether it is able to predict <i>y-</i>values for new <i>x-</i>values. </p>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>
<span class="n">numarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">numarray</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">numarray</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1">#printing coefficients</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="n">x_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="n">y_predict</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_predict</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
</pre></div>

          <p>Next, we have some sample data for the equation: <i>y = x + 1</i>. We will train our Linear Regression model test whether it is able to predict <i>y-</i>values for new <i>x-</i>values. </p>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>

<span class="n">numarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">numarray</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">numarray</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1">#printing coefficients</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="n">x_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="n">y_predict</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_predict</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
</pre></div>
          <p>But, what if we tried the Linear Regression model for the equation: <i>y = x<sup>2</sup></i>. What did you observe with the following code? Did it predict the <i>y-</i>values correctly?</p>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>

<span class="n">numarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">25</span><span class="p">]])</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">numarray</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">numarray</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1">#printing coefficients</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="n">x_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="n">y_predict</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_predict</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
</pre></div>

         <p>Now, Let's repeat the above experiment by making use of Polynomial features. Try changing the value of <i>degree</i> in the code given below. </p>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>

<span class="n">numarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">25</span><span class="p">]])</span>

<span class="c1">#using polynomial features</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x_poly</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">numarray</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_poly</span><span class="p">,</span> <span class="n">numarray</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1">#printing coefficients</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="n">x_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="n">y_predict</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_predict</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
</pre></div>
 
         <p>Now let's try with third order polynomial equation (cubic equation).</p>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>

<span class="n">numarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">64</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">125</span><span class="p">]])</span>

<span class="c1">#using polynomial features</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x_poly</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">numarray</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_poly</span><span class="p">,</span> <span class="n">numarray</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1">#printing coefficients</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="n">x_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="n">y_predict</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_predict</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
</pre></div>
         <p>Download the file <a href="../../2018/DataMining/population.csv">population.csv</a> (source: query given in <a href="./references.html">references</a>). We will first plot this multi-annual population.</p>
         <p class="codeexample">
          <code>
           import numpy as np<br/>
           import matplotlib.pyplot as plot<br/>
           import pandas as pd<br/>
           dataset = np.loadtxt("population.csv", dtype={'names': ('year', 'population'), 'formats': ('i4', 'i')},<br/>
           &nbsp;&nbsp;&nbsp;&nbsp;skiprows=1, delimiter=",", encoding="UTF-8")<br/>
           <br/>
           df = pd.DataFrame(dataset)<br/>
           df.plot(x='year', y='population', kind='scatter')<br/>
          </code>
         </p>
         <p>
           <img style="width:40%" src="../../2017/DataMining/images/populationscatterplot.png"></img>
         </p>
         <p>We will focus on data starting from 1960 (why?). Our goal is to use regression techniques to predict population. But we don't know how to verify. So with the available data, we create two categories: training data and test data.</p>
         <p>Now continuing with the population data (from TP1 and TP2), we split it into two: training data and test data. We will plot the actual population values and the predicted values.</p>
         <p class="codeexample">
          <code>
           import numpy as np<br/>
           import matplotlib.pyplot as plot<br/>
           import pandas as pd<br/>
           from sklearn.linear_model import LinearRegression<br/>
           dataset = np.loadtxt("population.csv", dtype={'names': ('year', 'population'), 'formats': ('i4', 'i')},<br/>
           &nbsp;&nbsp;&nbsp;&nbsp;skiprows=1, delimiter=",", encoding="UTF-8")<br/>
           <br/>
           df = pd.DataFrame(dataset[4:])<br/>
           <br/>
           #training data<br/>
           x_train = df['year'][:40].values.reshape(-1, 1)<br/>
           y_train = df['population'][:40].values.reshape(-1, 1)<br/>
           <br/>
           #training<br/>
           lr = LinearRegression()<br/>
           lr.fit(x_train, y_train)<br/>
           <br/>
           #printing coefficients<br/>
           print(lr.intercept_, lr.coef_)<br/>
           <br/>
           #prediction<br/>
           x_predict = x_train = df['year'][41:].values.reshape(-1, 1)<br/>
           y_actual = df['population'][41:].values.reshape(-1, 1) <br/>
           y_predict = lr.predict(x_predict)<br/>
           <br/>
           plot.scatter(x_predict, y_actual)<br/>
           plot.plot(x_predict, y_predict, color='red', linewidth=2)<br/>
           plot.show()<br/>
          </code>
         </p>
         <p>
           <img style="width:40%" src="../../2017/DataMining/images/populationlinearregression.png"></img>
         </p>
         <p>Now test the above program including the data before 1960. What did you notice? You may have got the following graph.</p>
         <p>
           <img style="width:40%" src="../../2017/DataMining/images/allpopulationlinearregression.png"></img>
         </p>
         <p>What are your observations? So the above program using linear regression perfectly fit for a subset of data. Let's now try with <b>polynomial features</b> with degree 2 (refer <a href="http://scikit-learn.org/stable/modules/linear_model.html#polynomial-regression-extending-linear-models-with-basis-functions">Polynomial Regression: Extending linear models</a>).</p>
         <p class="codeexample">
          <code>
           import numpy as np<br/>
           import matplotlib.pyplot as plot<br/>
           import pandas as pd<br/>
           from sklearn.linear_model import LinearRegression<br/>
           from sklearn.preprocessing import PolynomialFeatures<br/>
           dataset = np.loadtxt("population.csv", dtype={'names': ('year', 'population'), 'formats': ('i4', 'i')},<br/>
           &nbsp;&nbsp;&nbsp;&nbsp;skiprows=1, delimiter=",", encoding="UTF-8")<br/>
           <br/>
           df = pd.DataFrame(dataset[4:])<br/>
           <br/>
           #training data<br/>
           <br/>
           x_train = df['year'][:50].values.reshape(-1, 1)<br/>
           y_train = df['population'][:50].values.reshape(-1, 1)<br/>
           <br/>
           pf = PolynomialFeatures(degree=2)<br/>
           x_poly = pf.fit_transform(x_train)<br/>
           <br/>
           #training<br/>
           lr = LinearRegression()<br/>
           lr.fit(x_poly, y_train)<br/>
           <br/>
           #printing coefficients<br/>
           print(lr.intercept_, lr.coef_)<br/>
           <br/>
           #prediction<br/>
           x_predict = x_train = df['year'][41:].values.reshape(-1, 1)<br/>
           y_actual = df['population'][41:].values.reshape(-1, 1) <br/>
           y_predict = lr.predict(pf.fit_transform(x_predict))<br/>
           <br/>
           plot.scatter(x_predict, y_actual)<br/>
           plot.plot(x_predict, y_predict, color='red', linewidth=2)<br/>
           plot.show()<br/>
          </code>
         </p>
         <p>
           <img style="width:40%" src="../../2017/DataMining/images/populationpolynomialregression.png"></img>
         </p>
         <p>Before jumping into a conclusion, let's consider the entire data and see.</p>
         <p class="codeexample">
          <code>
           import numpy as np<br/>
           import matplotlib.pyplot as plot<br/>
           import pandas as pd<br/>
           from sklearn.linear_model import LinearRegression<br/>
           from sklearn.preprocessing import PolynomialFeatures<br/>
           dataset = np.loadtxt("population.csv", dtype={'names': ('year', 'population'), 'formats': ('i4', 'i')},<br/>
           &nbsp;&nbsp;&nbsp;&nbsp;skiprows=1, delimiter=",", encoding="UTF-8")<br/>
           <br/>
           df = pd.DataFrame(dataset)<br/>
           <br/>
           #training data<br/>
           <br/>
           x_train = df['year'][:40].values.reshape(-1, 1)<br/>
           y_train = df['population'][:40].values.reshape(-1, 1)<br/>
           <br/>
           pf = PolynomialFeatures(degree=2)<br/>
           x_poly = pf.fit_transform(x_train)<br/>
           <br/>
           #training<br/>
           lr = LinearRegression()<br/>
           lr.fit(x_poly, y_train)<br/>
           <br/>
           #printing coefficients<br/>
           print(lr.intercept_, lr.coef_)<br/>
           <br/>
           #prediction<br/>
           x_predict = x_train = df['year'][41:].values.reshape(-1, 1)<br/>
           <br/>
           # Let's add some more years<br/>
           x_predict = np.append(range(1900, 1959), x_predict)<br/>
           x_predict = x_predict.reshape(-1, 1)<br/>
           <br/>
           y_actual = df['population'][41:].values.reshape(-1, 1) <br/>
           y_predict = lr.predict(pf.fit_transform(x_predict))<br/>
           <br/>
           plot.scatter(df['year'], df['population'])<br/>
           plot.plot(x_predict, y_predict, color='red', linewidth=2)<br/>
           plot.show()<br/>
          </code>
         </p>
         <p>
           <img style="width:40%" src="../../2017/DataMining/images/allpopulationpolynomialregression.png"></img>
         </p>
         <p>What do you think? Can we use this program to predict the missing data (especially in the absence of other external source of information)? Try the above program with different degrees.</p>
        </div>
        <h4>Exercise 3.2 <span style="color:red">&#9733;&#9733;</span></h4>
        <div class="exercise">
         <p>Classifiers are helpful to classify our dataset into one or more classes. But unlike clustering algorithms, it's the user who has to classify the data in a classification algorithm. In the following exercises, we see different classifiers, starting with perceptron. Look at the input data (<i>numarray</i>) and the associated labels (<i>result</i>). Here, we will label the complete dataset and see whether our model (Perceptron) did work well.</p>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">Perceptron</span>

<span class="n">numarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">perceptron</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">perceptron</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">numarray</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<span class="n">x_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span>

<span class="n">y_predict</span> <span class="o">=</span> <span class="n">perceptron</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_predict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
</pre></div>


         <p>Now we will remove some labeled/classified data and see the predicted results. </p>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">Perceptron</span>

<span class="n">numarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> 
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> 
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> 
                     <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> 
                     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                     <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">perceptron</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">perceptron</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">numarray</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<span class="n">x_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">y_predict</span> <span class="o">=</span> <span class="n">perceptron</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_predict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
</pre></div>

         <p>Now, we will try another classifer: MLPClassifier</p>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="k">import</span> <span class="n">MLPClassifier</span>

<span class="n">numarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> 
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> 
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> 
                   <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> 
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">mlpclassifier</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">mlpclassifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">numarray</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<span class="n">x_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">y_predict</span> <span class="o">=</span> <span class="n">mlpclassifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_predict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
</pre></div>


         <p>Now, we will try another classifer using support vector machines.</p>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">svm</span><span class="p">,</span> <span class="n">metrics</span>

<span class="n">numarray</span> <span class="o">=</span> <span class="n">numarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> 
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> 
                     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> 
                   <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> 
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> 

<span class="n">svcclassifier</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">svcclassifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">numarray</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<span class="n">x_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">y_predict</span> <span class="o">=</span> <span class="n">svcclassifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_predict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
</pre></div>

         <p>We will now use scikit-learn and the classifiers seen above to recognize handwriting. Scikit-learn has a lot of datasets. We will use one such dataset called digits dataset, which consists of labeled handwriting images of digits. The following program will show the labels.</p>
         <p class="codeexample">
          <code>
             from sklearn import datasets<br/>
             import numpy as np<br/>
             <br/>
             digits = datasets.load_digits()<br/>
             <br/>
             print(np.unique(digits.target))<br/>
          </code>
         </p>
         <p>We will now see the total number of images and the contents of one test image.</p>
         <p class="codeexample">
          <code>
             from sklearn import datasets<br/>
             import numpy as np<br/>
             import matplotlib.pyplot as plot<br/>
             <br/>
             digits = datasets.load_digits()<br/>
             <br/>
             print("Number of images: ", digits.images.size)<br/>
             print("Input data: ", digits.images[0])<br/>
             print("Label:", digits.target[0])<br/>
             <br/>
             plot.imshow(digits.images[0], cmap=plot.cm.gray_r)<br/>
             plot.show()<br/>
          </code>
         </p>
         <p>We will now use a support vector classifier to train the data. We will split our data into two: training data and test data. Remember that we already have labels for the entire dataset.</p>
         <p class="codeexample">
          <code>
             from sklearn import datasets, svm<br/>
             import numpy as np<br/>
             import matplotlib.pyplot as plot<br/>
             <br/>
             digits = datasets.load_digits()<br/>
             <br/>
             training_images = digits.images[:int(digits.images.shape[0]/2)]<br/>
             training_images = training_images.reshape((training_images.shape[0], -1))<br/>
             <br/>
             training_target = digits.target[0:int(digits.target.shape[0]/2)]<br/>
             <br/>
             classifier = svm.SVC(gamma=0.001, C=100.)<br/>
             #training<br/>
             classifier.fit(training_images, training_target)<br/>
             <br/>
             #prediction<br/>
             predict_image = digits.images[int(digits.images.shape[0]/2)+2]<br/>
             print("Predicted value: ", classifier.predict(predict_image.reshape(1,-1)))<br/>
             <br/>
             plot.imshow(predict_image, cmap=plot.cm.gray_r)<br/>
             plot.show()<br/>
          </code>
         </p>
         <p>
           <img style="width:40%" src="../../2017/DataMining/images/scikitlearnfour.png"></img>
         </p>
         <p>Now let's try predicting the remaining labels and use the classifcation report to get the precision of prediction.</p>
         <p class="codeexample">
          <code>
             from sklearn import datasets, svm, metrics<br/>
             import numpy as np<br/>
             import matplotlib.pyplot as plot<br/>
             <br/>
             digits = datasets.load_digits()<br/>
             <br/>
             training_images = digits.images[:int(digits.images.shape[0]/2)]<br/>
             training_images = training_images.reshape((training_images.shape[0], -1))<br/>
             <br/>
             training_target = digits.target[0:int(digits.target.shape[0]/2)]<br/>
             <br/>
             classifier = svm.SVC(gamma=0.001, C=100.)<br/>
             #training<br/>
             classifier.fit(training_images, training_target)<br/>
             <br/>
             #prediction<br/>
             predict_images = digits.images[int(digits.images.shape[0]/2)+1:]<br/>
             actual_labels = digits.target[int(digits.target.shape[0]/2)+1:]<br/>
             predicted_labels = classifier.predict(predict_images.reshape((predict_images.shape[0], -1)))<br/>
             <br/>
             #classification report<br/>
             print(metrics.classification_report(actual_labels,predicted_labels))<br/>
          </code>
         </p>
         <p>There are other classifiers available. We will now work with Perceptron (refer <a href="http://scikit-learn.org/stable/modules/linear_model.html#perceptron">here</a>) and see its performance.</p>
         <p class="codeexample">
          <code>
             from sklearn import datasets, metrics<br/>
             from sklearn.linear_model import Perceptron<br/>
             import numpy as np<br/>
             import matplotlib.pyplot as plot<br/>
             <br/>
             digits = datasets.load_digits()<br/>
             <br/>
             training_images = digits.images[:int(digits.images.shape[0]/2)]<br/>
             training_images = training_images.reshape((training_images.shape[0], -1))<br/>
             <br/>
             training_target = digits.target[0:int(digits.target.shape[0]/2)]<br/>
             <br/>
             classifier = Perceptron(max_iter=1000)<br/>
             #training<br/>
             classifier.fit(training_images, training_target)<br/>
             <br/>
             #prediction<br/>
             predict_images = digits.images[int(digits.images.shape[0]/2)+1:]<br/>
             actual_labels = digits.target[int(digits.target.shape[0]/2)+1:]<br/>
             predicted_labels = classifier.predict(predict_images.reshape((predict_images.shape[0], -1)))<br/>
             <br/>
             #classification report<br/>
             print(metrics.classification_report(actual_labels,predicted_labels))<br/>
          </code>
         </p>
         <p>Finally, we will finish the test with Multilayer Perceptron (refer <a href="http://scikit-learn.org/stable/modules/neural_networks_supervised.html#multi-layer-perceptron">here</a>).</p>
         <p class="codeexample">
          <code>
             from sklearn import datasets, metrics<br/>
             from sklearn.neural_network import MLPClassifier<br/>
             import numpy as np<br/>
             import matplotlib.pyplot as plot<br/>
             <br/>
             digits = datasets.load_digits()<br/>
             <br/>
             training_images = digits.images[:int(digits.images.shape[0]/2)]<br/>
             training_images = training_images.reshape((training_images.shape[0], -1))<br/>
             <br/>
             training_target = digits.target[0:int(digits.target.shape[0]/2)]<br/>
             <br/>
             classifier = MLPClassifier(alpha=2, max_iter=1000)<br/>
             #training<br/>
             classifier.fit(training_images, training_target)<br/>
             <br/>
             #prediction<br/>
             predict_images = digits.images[int(digits.images.shape[0]/2)+1:]<br/>
             actual_labels = digits.target[int(digits.target.shape[0]/2)+1:]<br/>
             predicted_labels = classifier.predict(predict_images.reshape((predict_images.shape[0], -1)))<br/>
             <br/>
             #classification report<br/>
             print(metrics.classification_report(actual_labels,predicted_labels))<br/>
          </code>
         </p>
         <p>Did you try changing the number of hidden layers?</p>
         <p>What are your observations after trying the different classifiers? </p>
         <p>Your next question is to plot the confusion metrics for all the above three classifiers.</p>
        </div>
        <h4>Exercise 3.3 <span style="color:red">&#9733;&#9733;</span></h4>
        <div class="exercise">
          <p>In this practical session, we start experimenting with decision trees. We will first build a Decision Tree Classifier using a very simple example. Like the classifiers we have seen before, we will first try to fit our data and then predict a class for a previously unseen value.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="n">dtc</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
            </code>
          </p>
          <p>Our next goal is to visualize the decision tree. Look at the following code and see how we have given names to the two columns of the above data. We also gave name names to the <i>result</i> data entries, calling them <i>class1</i> and <i>class2</i>.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">import</span> <span class="nn">pydotplus</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<span class="n">dot_data</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">dtc</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;column1&#39;</span><span class="p">,</span> <span class="s1">&#39;column2&#39;</span><span class="p">],</span>
                                <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                <span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;class1&#39;</span><span class="p">,</span> <span class="s1">&#39;class2&#39;</span><span class="p">]</span>
                                <span class="p">)</span> 
<span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>
<span class="n">pydot_graph</span> <span class="o">=</span> <span class="n">pydotplus</span><span class="o">.</span><span class="n">graph_from_dot_data</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pydot_graph</span><span class="o">.</span><span class="n">create_png</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
            </code>
          </p>
          <p>Now, let's take some realistic example. In the following code, we consider 13 photographs marked by a user as 'Favorite' and 'NotFavorite'. For every photograph: we have four information: color, tag, size (medium sized, thumbnail etc.) and mode in which the photograph was taken (portrait or landscape). We will build a Decision Tree Classifier with this data. We will then predict whether our user will like a photograph of nature which has a predominant color red, of thumbnail size and taken in portrait mode.</p>
          <p>In the following code, we display two values. We predict whether the user will favorite the photograph or not. We also display the importance of each of the features: color, tag, size and mode.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">LabelEncoder</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span><span class="s1">&#39;landscape&#39;</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span>
          <span class="p">]</span>


<span class="c1">#creating dataframes</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">])</span>
<span class="n">resultframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#generating numerical labels</span>
<span class="n">le1</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>

<span class="n">le2</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>

<span class="n">le3</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>

<span class="n">le4</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le4</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

<span class="n">le5</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le5</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#Use of decision tree classifiers</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">resultframe</span><span class="p">)</span>

<span class="c1">#prediction</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span>
    <span class="p">[</span><span class="n">le1</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;red&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">le2</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;nature&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span>
     <span class="n">le3</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;thumbnail&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">le4</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;portrait&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">le5</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dtc</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)</span>
</pre></div>
            </code>
          </p>
          <p>What are your observations?</p>
          <p>Our next goal is to visualize the above decision tree. Test the code below. It's similar to the code we tested before. Take a look at the classes and the features.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">LabelEncoder</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">import</span> <span class="nn">pydotplus</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span><span class="s1">&#39;landscape&#39;</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span>
          <span class="p">]</span>


<span class="c1">#creating dataframes</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">])</span>
<span class="n">resultframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#generating numerical labels</span>
<span class="n">le1</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>

<span class="n">le2</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>

<span class="n">le3</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>

<span class="n">le4</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le4</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

<span class="n">le5</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le5</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#Use of decision tree classifiers</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">dtc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">resultframe</span><span class="p">)</span>

<span class="n">dot_data</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">dtc</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">feature_names</span><span class="o">=</span><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                     <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                     <span class="n">class_names</span> <span class="o">=</span>
                     <span class="n">le5</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
                       <span class="n">resultframe</span><span class="o">.</span><span class="n">favorite</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
                    <span class="p">)</span> 
<span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span> 
 
<span class="n">pydot_graph</span> <span class="o">=</span> <span class="n">pydotplus</span><span class="o">.</span><span class="n">graph_from_dot_data</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pydot_graph</span><span class="o">.</span><span class="n">create_png</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
            </code>
          </p>
          <p>What if we had a possibility of multiple decision trees? Let's predict using a Random Forest Classifier (can be seen as a collection of multiple decision trees). Check the predicted value as well as the importance of the different features. Note that we are asking to create 10 such estimators using a maximum depth of 2 for each of the estimator.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">LabelEncoder</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">import</span> <span class="nn">pydotplus</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span><span class="s1">&#39;landscape&#39;</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span>
          <span class="p">]</span>


<span class="c1">#creating dataframes</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">])</span>
<span class="n">resultframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#generating numerical labels</span>
<span class="n">le1</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>

<span class="n">le2</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>

<span class="n">le3</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>

<span class="n">le4</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le4</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

<span class="n">le5</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le5</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#Use of random forest classifier</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                             <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">resultframe</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="c1">#prediction</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span>
    <span class="p">[</span><span class="n">le1</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;red&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">le2</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;nature&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span>
     <span class="n">le3</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;thumbnail&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">le4</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;portrait&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">le5</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rfc</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)</span>
</pre></div>
            </code>
          </p>
          <p>Finally we visualize these estimators.</p>
          <p class="codeexample">
            <code>
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">tree</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">LabelEncoder</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">import</span> <span class="nn">pydotplus</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;nature&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span> <span class="s1">&#39;portrait&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;people&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;landscape&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;thumbnail&#39;</span><span class="p">,</span><span class="s1">&#39;landscape&#39;</span><span class="p">]]</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Favorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span><span class="p">,</span>
          <span class="s1">&#39;NotFavorite&#39;</span>
          <span class="p">]</span>


<span class="c1">#creating dataframes</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">])</span>
<span class="n">resultframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#generating numerical labels</span>
<span class="n">le1</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>

<span class="n">le2</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>

<span class="n">le3</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">])</span>

<span class="n">le4</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le4</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

<span class="n">le5</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le5</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">resultframe</span><span class="p">[</span><span class="s1">&#39;favorite&#39;</span><span class="p">])</span>

<span class="c1">#Use of decision tree classifiers</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                             <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,)</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">resultframe</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">dot_data</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">rfc</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">out_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">feature_names</span><span class="o">=</span><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                   <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">class_names</span> <span class="o">=</span>
                    <span class="n">le5</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
                      <span class="n">resultframe</span><span class="o">.</span><span class="n">favorite</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
                   <span class="p">)</span> 
    <span class="n">graph</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span> 
    <span class="n">pydot_graph</span> <span class="o">=</span> <span class="n">pydotplus</span><span class="o">.</span><span class="n">graph_from_dot_data</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pydot_graph</span><span class="o">.</span><span class="n">create_png</span><span class="p">())</span>
    <span class="n">display</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
            </code>
          </p>
        </div>
        <h4>Exercise 3.4 <span style="color:red">&#9733;&#9733;</span></h4>
        <div class="exercise">
          <p>We now split our MNIST (handwriting) data into two: training data and test data for creating models for prediction and we fed the complete training data to our classifier. However, in real life, we may have new data to train. Check the following code using perceptron and compare it with the code of exercise 3.3</p>
          <p class="codeexample">
            <code>
              from sklearn import datasets, metrics<br/>
              from sklearn.linear_model import Perceptron<br/>
              import numpy as np<br/>
              import matplotlib.pyplot as plot<br/>
              <br/>
              digits = datasets.load_digits()<br/>
              training_size = int(digits.images.shape[0]/2)<br/>
              <br/>
              training_images = digits.images[0:training_size]<br/>
              training_images = training_images.reshape((training_images.shape[0], -1))<br/>
              <br/>
              training_target = digits.target[0:training_size]<br/>
              <br/>
              classifier = Perceptron(max_iter=1000)<br/>
              #training<br/>
              for i in range(training_size):<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;training_data = np.array(training_images[i])<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;training_data = training_data.reshape(1, -1)<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;classifier.partial_fit(training_data, [training_target[i]], classes=np.unique(digits.target))<br/>
              <br/>
              #prediction<br/>
              predict_images = digits.images[training_size+1:]<br/>
              actual_labels = digits.target[training_size+1:]<br/>
              predicted_labels = classifier.predict(predict_images.reshape((predict_images.shape[0], -1)))<br/>
              <br/>
              #classification report<br/>
              print(metrics.classification_report(actual_labels,predicted_labels))<br/>
            </code>
          </p>
          <p>This approach is called <a href="https://en.wikipedia.org/wiki/Online_machine_learning">online machine training</a> (or <a href="https://fr.wikipedia.org/wiki/Algorithme_d%27apprentissage_incr%C3%A9mental">algorithme d'apprentissage incrémental (fr)</a>). Did you get good precision? </p>
           <p>Your next question is to modify the above program and test online training with <b>MLPClassifier</b>.</p>
           <p>Try modifying (reducing and increasing) the training data size. What are your observations?</p>
        </div>
        <h4>Exercise 3.5 <span style="color:red">&#9733;&#9733;</span></h4>
        <div class="exercise">
         <p>Your final exercise is to use <a href="https://www.tensorflow.org/">Tensorflow</a>. We will use a Deep Neural Network (DNN) classifier with two hidden layers.</p>
         <p>Recall that we have already used Multilayer perceptron (MLP), a subset of Deep Neural Network in our preceding practical session. We will first predict an image of a digit using <a href="https://web.archive.org/web/20190602073143/https://www.tensorflow.org/api_docs/python/tf/contrib/learn/DNNClassifier">DNNClassifier</a>.</p>
         <p class="codeexample">
          <code>
              import tensorflow as tf<br/>
              from sklearn import datasets<br/>
              import matplotlib.pyplot as plot<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;<br/>
              digits = datasets.load_digits()<br/>
              training_size = int(digits.images.shape[0]/2)<br/>
              <br/>
              training_images = digits.images[0:training_size]<br/>
              training_images = training_images.reshape((training_images.shape[0], -1))<br/>
              <br/>
              training_target = digits.target[0:training_size]<br/>
              <br/>
              classifier = tf.contrib.learn.DNNClassifier(<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    feature_columns=[tf.contrib.layers.real_valued_column("", dtype=tf.float64)],<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 2  hidden layers of 50 nodes each<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    hidden_units=[50, 50],<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 10 classes: 0, 1, 2...9<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;     n_classes=10)<br/>
              <br/>
              #training<br/>
              classifier.fit(training_images, training_target, steps=100)<br/>
              <br/>
              #prediction<br/>
              predict_images = digits.images[training_size+1:]<br/>
              <br/>
              predict = classifier.predict(predict_images[16].reshape(1,-1))<br/>
              print(list(predict))<br/>
              plot.imshow(predict_images[16], cmap=plot.cm.gray_r)<br/>
              plot.show()<br/>
          </code>
         </p>
         <p>Did it work? Let's now try to get the accuracy of our model. Will it work for our entire test data?</p>
         <p class="codeexample">
          <code>
              import tensorflow as tf<br/>
              from sklearn import datasets<br/>
              import matplotlib.pyplot as plot<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;<br/>
              digits = datasets.load_digits()<br/>
              training_size = int(digits.images.shape[0]/2)<br/>
              <br/>
              training_images = digits.images[0:training_size]<br/>
              training_images = training_images.reshape((training_images.shape[0], -1))<br/>
              <br/>
              training_target = digits.target[0:training_size]<br/>
              <br/>
              classifier = tf.contrib.learn.DNNClassifier(<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    feature_columns=[tf.contrib.layers.real_valued_column("", dtype=tf.float64)],<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 2  hidden layers of 50 nodes each<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    hidden_units=[50, 50],<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 10 classes: 0, 1, 2...9<br/>
              &nbsp;&nbsp;&nbsp;&nbsp;     n_classes=10)<br/>
              <br/>
              #training<br/>
              classifier.fit(training_images, training_target, steps=100)<br/>
              <br/>
              #prediction<br/>
              predict_images = digits.images[training_size+1:]<br/>
              actual_labels = digits.target[training_size+1:]<br/>
              evaluation = classifier.evaluate(x=predict_images.reshape((predict_images.shape[0], -1)), y=actual_labels)<br/>
              print(evaluation['accuracy'])<br/>
          </code>
         </p>
         <p>What is the accuracy that you got? Now change the number of neurons in each layer (currently it is set to 50 each). Also try to increase the number of hidden layers. Did your accuracy improve?</p>
        </div>
        <h4>Exercise 3.5 <span style="color:red">&#9733;&#9733;&#9733;</span></h4>
        <div class="exercise">
         <h5>Project: Image recommender system: 3 practical sessions</h5>
         <p>Recall that the goal of this project is to recommend images based on the color preferences of the user. We will build this system in three practical sessions.</p>
         <p>During your last practical session, you collected images and obtained the predominant colors in each image. Now with your knowledge in different types of classifiers and clustering algorithms, what more information will you add for every image?</p>
         <p>For every image, you already may have the following information. If not, you can obtain these information based on the exercises already done so far.</p>
         <ol>
          <li>Predominant colors in an image</li>
          <li>Image size</li> 
          <li>How about asking users to tag the images? E.g., colors, cat, flower, sunflower, rose etc.</li>
          <li>...</li>
         </ol>
         <p>Ask the user to select some images. We may assume that those images contain the favorite colors of the user, or other favorite characteristics. For every user, you are now in a position to build user-preference profile</p>
         <ol>
          <li>Favorite colors</li>
          <li>Favorite image sizes (thumbnail images, large images, medium-size images etc.)</li>
          <li>Tags</li>
          <li>...</li>
         </ol>
         <p>Are you now in a position to recommend images to a user? What's missing? What are the limitations of your proposed approach?</p>
        </div>
        <h4>Submission</h4>
        <ul>
          <li>Rename your notebook as Name1_Name2_[Name3].ipynb, where Name1, Name2 are your names.</li>
          <li>Submit your notebook online.</li>
          <li>Please <b>don't</b> submit your JSON, TSV and CSV files.</li>
        </ul>
        <h4>References</h4>
        <p><a href="./references.html">Link</a></p>
      </div>
  </body>
</html>
