<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Language" content="en"/>
    <link rel="shortcut icon" href="../../images/logo/favicon.png"/>
    <title>Data Mining (2017-2018): Practicals 2: John Samuel</title>
    <style type="text/css">
    body{
      background-color: #FFFFFF;
    }
    #sidebar {
      position: fixed;
      background-color: #00363a;
      top: 0;
      left: 0;
      bottom: 0;
      width:25vw;
    }
    #sidebar .title {
      position:relative;
      text-align: center;
      line-height: 5vmax;
      font-size: 1.4vmax;
      font-family: 'Arial';
      margin-top: 30vh;
    }
    #sidebar .title a:link,
    #sidebar .title a:visited{
     color: #FFFFFF;
     text-decoration:none;
    }
    .subtitle {
      top: 50vh;
      text-align: center;
      line-height: 1.3vmax;
      font-family: 'Arial';
      font-size: 1.5vmax;
      color: #FFFFFF;
    }
    a:link, a:visited {
     color:#00363a;
    }
    .subtitle a:link,
    .subtitle a:visited{
     color: #FFFFFF;
     text-decoration:none;
    }
    .licence {
      position:fixed;
      text-align: right;
      bottom:0;
      right:0;
    }
    .home {
     position:fixed;
     text-align: left;
     font-family: 'Arial';
     color: #D3D3D3;
     z-index:100;
     width:100%;
     background-color:#FFFFFF;
     top:0px;
     margin-bottom:10px;
     padding-bottom:10px;
    }
    .codeexample {
      background-color:#eeeeee;
    }
    .home ul{
      margin: 0;
      padding: 0;
      text-align: left;
      list-style:none;
    }
    .home li{
     position: relative;
     float: left;
     padding-top:15px;
     margin-right: 1em;
     font-family: 'Arial';
    }
    .home li:hover {
      display:block;
    }
    .home a:link,
    .home a:visited{
     color: #D3D3D3;
    }
    .home li:hover a:link,
    .home li:hover a:visited{
      text-decoration:none;
      padding:15px;
      color:#FFFFFF;
      background-color: #00363a;
    }
    .content {
     line-height: 1.8vmax;
     font-size: 1.2vmax;
     font-family: 'Arial';
     margin-top: 15vh;
     width:90%;
    }
    .content h2, h3, h4{
     color:#00363a;
    }
    .content a:link,
    .content a:visited{
     color: #00363a;
    }
    .content h2::before,
    .content h3::before{
       display: block;
       content : " ";
       visibility:hidden;
       height:50px;
       margin-top:-50px;
       pointer-events: none;
       background-color:#FFFFFF;
    }
    .content a:link,
    .content a:visited{
     color:#00363a;
    }
    .content li {
      margin:5px;
    }
    .exercise {
     margin-left:2vw;
    }
    .exercise p{
     margin-left:1vw;
    }
    .exercise img{
     width:100%;
    }
    .content a:link,
    .content a:visited{
     color:#00363a;
    }
    .home a:link,
    .home a:visited{
     color: #D3D3D3;
    }
    .page {
      width:65vw;
      height:100%;
      margin-left:25vw;
      overflow: auto;
      padding: 0 1em;
    }
    img {
     max-width:100%;
     max-height:100%;
    }
    /* Using same Jupyter CSS
     */
    .highlight  { background: #f8f8f8; }
    .highlight .c { color: #408080; font-style: italic } /* Comment */
    .highlight .err { border: 1px solid #FF0000 } /* Error */
    .highlight .k { color: #008000; font-weight: bold } /* Keyword */
    .highlight .o { color: #666666 } /* Operator */
    .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
    .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
    .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
    .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
    .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
    .highlight .k { color: #008000; font-weight: bold } /* Keyword */
    .highlight .s2 { color: #BA2121 } /* Literal.String.Double */
    .highlight .s1 { color: #BA2121 } /* Literal.String.Single */
    .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
    .highlight .nb { color: #008000 } /* Name.Builtin */
    .highlight .mb { color: #666666 } /* Literal.Number.Bin */
    .highlight .mf { color: #666666 } /* Literal.Number.Float */
    .highlight .mh { color: #666666 } /* Literal.Number.Hex */
    .highlight .mi { color: #666666 } /* Literal.Number.Integer */
    .highlight .mo { color: #666666 } /* Literal.Number.Oct */
    @media (max-width: 640px), screen and (orientation: portrait) {
      body {
        max-width:100%;
        max-height:100%;
      }
      #sidebar {
        position: fixed;
        background-color: #00363a;
        top: 0;
        left: 0;
        bottom: 80vh;
        width:100vw;
      }
      #sidebar .title {
        text-align: center;
        position: fixed;
        margin-top: 6vh;
        left:0px;
        right:0px;
        line-height: 3.5vmax;
        font-size: 1.5vmax;
        font-family: 'Arial';
      }
      #sidebar .subtitle {
        text-align:center;
        top: 5vh;
        left:0px;
        right:0px;
        position: fixed;
        margin-top: 10vh;
        font-size: 1.5vmax;
      }
      #sidebar .title a:link,
      #sidebar .title a:visited{
        text-align:center;
        color:#FFFFFF;
      }
      #sidebar .subtitle a:link,
      #sidebar .subtitle a:visited{
        text-align:center;
        color:#FFFFFF;
      }
      .home{
        z-index:100;
        width:100%;
        background-color:#00363a;
        font-size:1.5vmax;
      }
      .home a:link,
      .home a:visited{
        text-decoration:none;
        color:#FFFFFF;
      }
      .content {
        line-height: 3.8vmax;
        font-size: 1.8vmax;
        font-family: 'Arial';
        margin-top:22vh;
      }
      .content a:link,
      .content a:visited{
        color:#00363a;
      }
      .page {
        top: 40vh;
        width:95%;
        margin-left:0vw;
      }
      .page img {
        max-width:100%;
        max-height:100%;
        border:0;
      }
    }

    </style>
  </head>
  <body vocab="http://schema.org/">
    <div id="sidebar">
     <div class="title">
      <h1><a href="./index.html">Practicals: Data Mining</a></h1>
     </div>
     <div class="subtitle">
      <h3><a href="../../../../about.html">John Samuel</a></h3>
     </div>
    </div>
    <div class="licence"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="./../../../../../images/license.png"/></a>
    </div>
    <div class="page">
      <div class="home">
       <ul typeof="BreadcrumbList">
        <li property="itemListElement" typeof="ListItem">
          <a property="item" typeof="WebPage" href="../../../../index.html">
            <span property="name">Home</span>
          </a>
        </li>
        <li property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="index.html">
          <span property="name">Data Mining</span>
         </a>
        </li>
        <li property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="../../../index.html">
          <span property="name">Teaching</span>
         </a>
        </li>
       </ul>
      </div>
      <div class="content">
        <h3>Goals</h3>
        <ol>
          <li>Plotting graphs using <a href="https://matplotlib.org/api/pyplot_api.html">matplotlib</a></li>
          <li>Reading and plotting image histograms.</li>
          <li>Working with <a href="http://scikit-learn.org/stable/modules/clustering.html">clustering</a> and <a href="http://scikit-learn.org/stable/modules/svm.html">classification</a> algorithms</li>
          <li>Start building a <a href="https://en.wikipedia.org/wiki/Recommender_system">recommender system</a></li>
        </ol>
        <h3>Scoring</h3>
        <p>Every exercise has an associated difficulty level. Easy and medium-difficult exercises help you understand the fundamentals and give you ideas to work on difficult exercises. It is highly recommended that you finish easy and medium-difficult exercises to have a good score. Given below is the difficulty scale that will be marked with every exercise: </p>
        <ol>
          <li><span style="color:red">&#9733;</span>: Easy</li>
          <li><span style="color:red">&#9733;&#9733;</span>: Medium</li>
          <li><span style="color:red">&#9733;&#9733;&#9733;</span>: Difficult</li>
        </ol>
        <h3>Guidelines</h3>
        <ol>
          <li>To get complete guidance from the mentors, it is highly recommended that you work on today's practical session and not on the preceding ones.</li>
          <li>Make sure that you rename your submissions properly and correctly. Double-check your submissions.</li>
          <li>Please check the <a href="./references.html">references</a>.</li>
          <li>There are several ways to achieve a task. Hence there are many possible solutions. But try to make maximum use of the libraries that have been suggested to you for your exercises.</li>
        </ol>
        <h4>Installation</h4>
        <div class="exercise">
          <p>Please refer <a href="./installation.html">installation</a> page.</p>
        </div>
        <h4>Exercise 2.1 <span style="color:red">&#9733;</span></h4>
        <div class="exercise">
          <p><a href="https://matplotlib.org/api/pyplot_api.html">matplotlib</a> can be used to plot graphs. Given below is a very simple code with only x values. After importing the <i>matplotlib</i> library, we initialize x values and plot it.</p>
          <p class="codeexample">
           <code>
             import matplotlib.pyplot as plot</br>
             </br>
             x = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</br>
             plot.plot(x)</br>
             plot.show()</br>
           </code>
          </p>
          <p>
            <img style="width:40%" src="./images/plot.png"></img>
          </p>
          <p>Now let's change the color, style and width of the line.</p>
          <p class="codeexample">
           <code>
             import matplotlib.pyplot as plot</br>
             </br>
             x = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</br>
             plot.plot(x, linewidth=3, drawstyle="steps", color="#00363a")</br>
             plot.show()</br>
           </code>
          </p>
          <p>We will now initialize the y-values and plot the graph.</p>
          <p class="codeexample">
           <code>
             import matplotlib.pyplot as plot</br>
             </br>
             x = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</br>
             y = [0, 1, 0, 0, 1, 0, 1, 1, 1, 0]</br>
             plot.plot(x, y, linewidth=3, drawstyle="steps", color="#00363a")</br>
             plot.show()</br>
           </code>
          </p>
          <p>
            <img style="width:40%" src="./images/stepploty.png"></img>
          </p>
          <p>In the <a href="./practicals1.html">first practical session</a>, we saw how to parse JSON files. Continuing with the same <a href="./pl.json">JSON</a> file, we will now plot the results of number of programming languages released per year. Verify the output.</p>
          <p class="codeexample">
           <code>
             from pandas.io.json import json_normalize</br>
             import pandas as pd</br>
             import json</br>
             import matplotlib.pyplot as plot</br>
             </br>
             data = json.load(open('pl.json'))</br>
             dataframe = json_normalize(data)</br>
             grouped = dataframe.groupby('year').count()</br>
             plot.plot(grouped)</br>
             plot.show()</br>
           </code>
          </p>
          <p>Following program will add title and labels to the x-axis and y-axis.</p>
          <p class="codeexample">
           <code>
             from pandas.io.json import json_normalize</br>
             import pandas as pd</br>
             import json</br>
             import matplotlib.pyplot as plot</br>
             </br>
             data = json.load(open('pl.json'))</br>
             dataframe = json_normalize(data)</br>
             grouped = dataframe.groupby('year').count()</br>
             plot.plot(grouped)</br>
             plot.title("Programming languages per year")</br>
             plot.xlabel('year',  fontsize=16)</br>
             plot.ylabel('count',  fontsize=16)</br>
             plot.show()</br>
           </code>
          </p>
          <p>There is yet another way to plot the dataframes, by using <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.plot.html">pandas.DataFrame.plot</a>.</p>
          <p class="codeexample">
           <code>
             from pandas.io.json import json_normalize</br>
             import pandas as pd</br>
             import json</br>
             import matplotlib.pyplot as plot</br>
             </br>
             data = json.load(open('pl.json'))</br>
             dataframe = json_normalize(data)</br>
             </br>
             grouped = dataframe.groupby('year').count()</br>
             grouped = grouped.rename(columns={'languageLabel':'count'}).reset_index()</br>
             </br>
             grouped.plot(x=0, kind='bar', title="Programming languages per year")</br>
           </code>
          </p>
          <p>
            <img style="width:40%" src="./images/dataframeplot.png"></img>
          </p>
          <p>Now, we want to create multiple subplots. A simple way is given below. Recall in <a href="./practicals1.html">first practical session</a>, we did group by on multiple columns. Subplots can be used to visualize these data.
          </p>
          <p class="codeexample">
           <code>
             from pandas.io.json import json_normalize</br>
             import pandas as pd</br>
             import json</br>
             import math</br>
             import matplotlib.pyplot as plot</br>
             </br>
             jsondata = json.load(open('plparadigm.json'))</br>
             array = []</br>
             </br>
             for data in jsondata:</br>
             &nbsp;&nbsp;&nbsp;&nbsp;array.append([data['year'], data['languageLabel'], data['paradigmLabel']])</br>
             </br>
             dataframe = pd.DataFrame(array, columns=['year', 'languageLabel', 'paradigmLabel'])</br>
             dataframe = dataframe.astype(dtype= {"year" : "int64", "languageLabel" : "&lt;U200", "paradigmLabel" : "&lt;U200"})</br>
             </br>
             grouped = dataframe.groupby(['paradigmLabel', 'year']).count()</br>
             grouped = grouped.rename(columns={'languageLabel':'count'})</br>
             grouped = grouped.groupby(['paradigmLabel'])</br>
             </br>
             #Initialization of subplots</br>
             nr = math.ceil(grouped.ngroups/2)</br>
             fig, axes = plot.subplots(nrows=nr, ncols=2, figsize=(20,25))</br>
             </br>
             #Creation of subplots</br>
             for i, group in enumerate(grouped.groups.keys()):</br>
             &nbsp;&nbsp;&nbsp;&nbsp;g = grouped.get_group(group).reset_index()</br>
             &nbsp;&nbsp;&nbsp;&nbsp;g.plot(x='year', y='count', kind='bar', title=group, ax=axes[math.floor(i/2),i%2])</br>
             </br>
             plot.show()</br>
           </code>
          </p>
          <p>
            <img style="width:50%" src="./images/subplots.png"></img>
          </p>
          Make changes to the above code, so that we can get visual information on count of different programming paradigms released in every available year.
        </div>
        <h4>Exercise 2.2 <span style="color:red">&#9733;</span></h4>
        <div class="exercise">
         <p>In this exercise, we will work on images. Download an image (e.g., <a href="./images/picture.bmp">picture.bmp</a> and <a href="./images/flower.jpg">flower.jpg</a>) in your current working folder and open it in the following manner. We will first try to get some metadata of the image.</p>
         <p class="codeexample">
          <code>
             import os,sys</br>
             from PIL import Image</br>
             imgfile = Image.open("picture.bmp")</br>
             print(imgfile.size, imgfile.format)</br>
          </code>
         </p>
         <p>We use Image module of Python PIL library (<a href="http://www.effbot.org/imagingbook/image.htm">Documentation</a>). We will now try to get data of 100 pixels from an image. </p>
         <p class="codeexample">
          <code>
             import os,sys</br>
             from PIL import Image</br>
             imgfile = Image.open("flower.jpg")</br>
             </br>
             data = imgfile.getdata()</br>
             </br>
             for i in range(10):</br>
             &nbsp;&nbsp;&nbsp;&nbsp;for j in range(10):</br>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(i,j, data.getpixel((i,j)))</br>
          </code>
         </p>
         <p>You may notice the pixel position and pixel values (a tuple of 3 values). Let's try to get additional metadata of the images, i.e., mode of image (e.g., RGB), number of bands, number of bits for each band, width and height of image (in pixels).</p>
         <p class="codeexample">
          <code>
             import os,sys</br>
             from PIL import Image</br>
             imgfile = Image.open("flower.jpg")</br>
             </br>
             print(imgfile.mode, imgfile.bands, imgfile.bits, imgfile.width, imgfile.height)</br>
          </code>
         </p>
         <p>Let's now get an histogram of colors. When you execute the following code, you will get a single array of values, frequency of each band (R, G, B etc.) concatenated together. In the following code, we will assume that we are working with an image of 3 bands (RGB mode) and each band is represented by 8 bits. We will plot the <a href="http://www.effbot.org/imagingbook/image.htm#tag-Image.Image.histogram">histogram</a> of different colors.</p>
         <p class="codeexample">
          <code>
             from PIL import Image</br>
             import matplotlib.pyplot as plot</br>
             </br>
             imgfile = Image.open("flower.jpg")</br>
             </br>
             histogram = imgfile.histogram()</br>
             red = histogram[0:255]</br>
             green = histogram[256:511]</br>
             blue = histogram[512:767]</br>
             </br>
             fig, (axis1, axis2, axis3) = plot.subplots(nrows=3, ncols=1)</br>
             axis1.plot(red, color='red')</br>
             axis2.plot(green, color='green')</br>
             axis3.plot(blue, color='blue')</br>
             plot.show()</br>
           </code>
          </p>
          <p>
            <img style="width:40%" src="./images/histogramsubplots.png"></img>
          </p>
          <p>But if wish to see all of them in one single plot.</p>
          <p class="codeexample">
           <code>
             from PIL import Image</br>
             import matplotlib.pyplot as plot</br>
             </br>
             imgfile = Image.open("flower.jpg")</br>
             </br>
             histogram = imgfile.histogram()</br>
             red = histogram[0:255]</br>
             green = histogram[256:511]</br>
             blue = histogram[512:767]</br>
             </br>
             x=range(255)</br>
             </br>
             y = []</br>
             for i in x:</br>
             &nbsp;&nbsp;&nbsp;&nbsp;y.append((red[i],green[i],blue[i]))</br>
             </br>
             plot.plot(x,y)</br>
             plot.show()</br>
           </code>
          </p>
          <p>
            <img style="width:40%" src="./images/histogramplot.png"></img>
          </p>
          <p>But we do not wish to loose the band colors.</p>
          <p class="codeexample">
           <code>
             from PIL import Image</br>
             import matplotlib.pyplot as plot</br>
             </br>
             imgfile = Image.open("flower.jpg")</br>
             </br>
             histogram = imgfile.histogram()</br>
             red = histogram[0:255]</br>
             green = histogram[256:511]</br>
             blue = histogram[512:767]</br>
             </br>
             x=range(255)</br>
             </br>
             y = []</br>
             for i in x:</br>
             &nbsp;&nbsp;&nbsp;&nbsp;y.append((red[i],green[i],blue[i]))</br>
             </br>
             figure, axes = plot.subplots()</br>
             axes.set_prop_cycle('color', ['red', 'green', 'blue'])</br>
             plot.plot(x,y)</br>
             plot.show()</br>
           </code>
          </p>
          <p>
            <img style="width:40%" src="./images/histogramplotcolors.png"></img>
          </p>
          <p>Your next question is to get the top 20 colors in each band and create a single plot of histogram of these top colors. Write a python program that can achieve this. </p>
        </div>
        <h4>Exercise 2.3 <span style="color:red">&#9733;&#9733;</span></h4>
        <div class="exercise">
        <p>In this exercise, we will take a look at <a href="http://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html">KMeans clustering algorithm</a>. Continuing with images, we will now find 4 predominant colors in an image.</p>
          <p class="codeexample">
           <code>
             from PIL import Image</br>
             import numpy</br>
             import math</br>
             import matplotlib.pyplot as plot</br>
             from sklearn.cluster import KMeans</br>
             </br>
             imgfile = Image.open("flower.jpg")</br>
             </br>
             numarray = numpy.array(imgfile.getdata(), numpy.uint8)</br>
             </br>
             clusters = KMeans(n_clusters = 4)</br>
             clusters.fit(numarray)</br>
             </br>
             </br>
             npbins = numpy.arange(0, 5)</br>
             histogram = numpy.histogram(clusters.labels_, bins=npbins)</br>
             labels = numpy.unique(clusters.labels_)</br>
             </br>
             </br>
             barlist = plot.bar(labels, histogram[0])</br>
             for i in range(4):</br>
             &nbsp;&nbsp;&nbsp;&nbsp;barlist[i].set_color('#%02x%02x%02x' % (math.ceil(clusters.cluster_centers_[i][0]), </br>
             &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;math.ceil(clusters.cluster_centers_[i][1]), math.ceil(clusters.cluster_centers_[i][2])))</br>
             plot.show()</br>
             </br>
           </code>
          </p>
          <p>
            <img style="width:40%" src="./images/barchart.png"></img>
          </p>
          <p>For your next question, your goal is to understand the above code and achieve the following:
            <ol>
             <li>Assume that the number of clusters is given by the user, generalize the above code.</li>
             <li>In case of bar chart, ensure that the bars are arranged in the descending order of the frequency of colors.</li>
             <li>Also add support for pie chart in addition to the bar chart. Ensure that we use the image colors as the wedge colors. (e.g., given below)</li>
             <li>Do you have any interesting observations?</li>
            </ol>
          </p>
          <p>
            <img style="width:40%" src="./images/piechart.png"></img>
          </p>
        </div>
        <h4>Exercise 2.4 <span style="color:red">&#9733;&#9733</span></h4>
        <div class="exercise">
        <p>In this exercise, we will explore <a href="http://scikit-learn.org/stable/modules/svm.html">Support vector machines (SVM)</a> for classification. We will now use colors. Given a RGB number, we want to classify a number into reddish and non-reddish colors.</p>
          <p class="codeexample">
           <code>
             from sklearn import svm</br>
             x = [[186, 0, 13], [255, 121, 97], [244, 67, 54],[69, 39, 160],[121, 83, 210],[0, 51, 0],[27, 94, 32]]</br>
             y = [1, 1, 1,0,0,0,0]</br>
             clf = svm.SVC()</br>
             clf.fit(x, y)</br>
             </br>
             print(clf.predict([[186, 0, 13]]))</br>
             print(clf.predict([[30, 136, 229]]))</br>
           </code>
          </p>
          <p>Look at the training data (x,y). We first use the data to train our classifier. Then we try to predict a new color. We first try with one element of our training data and later with a new color.</p>
          <p>Your next goal is to achieve multi-class classification.</p>
          <ol>
           <li>Train a classifier that can classify three colors: reddish, bluish and greenish colors.</li>
           <li>Test your classifier with new colors.</li>
           <li>What are your observations?</li>
          </ol>
        </div>
        <h4>Exercise 2.5: Project <span style="color:red">&#9733;&#9733;&#9733;</span></h4>
        <div class="exercise">
         <h5>Project: Image recommender system: 3 practical sessions</h5>
         <p>The goal of this project is to recommend images based on the color preferences of the user. We will build this system in three practical sessions.</p>
         We have to collect the following data.
         <ol>
          <li>A set of images and the predominant colors in each image.</li>
          <li>Ask the user to select some images. We assume that the chosen images contain the favourite colors of the user.</li>
          <li>We analyse user color-preferences and predominant colors of available images to propose new images to the user.</li>
         </ol>
         <p>For this question, we start with analysing predominant images. You have the following tasks to program:</p>
         <ol>
          <li>Create a folder called <i>testimages</i>.</li>
          <li>Download open-licensed images to the folder <i>testimages</i>.</li>
          <li>Get N (configurable number) colors of each test image and save this information in a JSON file.</li>
         </ol>
        </div>
        <h4>Submission</h4>
        <ul>
          <li>Rename your notebook as Name1_Name2_[Name3].ipynb, where Name1, Name2 are your names.</li>
          <li>Submit your notebook online.</li>
          <li>Please <b>don't</b> submit your JSON, TSV and CSV files.</li>
        </ul>
        <h4>References</h4>
        <p><a href="./references.html">Link</a></p>
      </div>
  </body>
</html>
