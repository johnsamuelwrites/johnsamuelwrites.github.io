<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Language" content="en"/>
    <link rel="shortcut icon" href="../../images/logo/favicon.png"/>
    <title>Data Mining: John Samuel</title>
    <style type="text/css">
    body{
      background-color: #FFFFFF;
    }
    #sidebar {
      position: fixed;
      background-color: #00363a;
      top: 0;
      left: 0;
      bottom: 0;
      width:25vw;
    }
    .title {
      position:relative;
      text-align: center;
      line-height: 9vh;
      font-size: 1.5vmax;
      font-family: 'Arial';
      margin-top: 40vh;
    }
    .title a:link, 
    .title a:visited{
     color: #FFFFFF;
     text-decoration:none;
    }
    .subtitle {
      top: 50vh;
      text-align: center;
      line-height: 1.3em;
      font-family: 'Arial';
      font-size: 1.5vmax;
      color: #FFFFFF;
    }
    a:link, a:visited {
     color:#00363a;
    }
    .subtitle a:link,
    .subtitle a:visited{
     color: #FFFFFF;
     text-decoration:none;
    }
    .licence {
      position:fixed;
      text-align: right;
      bottom:0;
      right:0;
    }
    .home {
     font-family: 'Arial';
     text-align: left;
    }
    .codeexample {
      background-color:#eeeeee;
    }
    .home ul{
      margin: 0;
      padding: 0;
      text-align: left;
      list-style:none;
    }
    .home li{
     position: relative;
     float: left;
     margin-right: 1em;
    }
    .content {
     line-height: 1.6em;
     font-size: 1.3em;
     font-family: 'Arial';
     margin-top: 8vh;
    }
    .content h3,h2,h4{
     color:#00363a;
    }
    .exercise {
     margin-left:2vw;
    }
    .exercise p{
     margin-left:1vw;
    }
    .exercise img{
     width:100%;
    }
    .content a:link,
    .content a:visited{
     color:#00363a;
    }
    .home a:link,
    .home a:visited{
     color: #D3D3D3;
    }
    .page {
      width:65vw;
      height:100%;
      margin-left:25vw;
      overflow: auto;
      padding: 0 1em;
    }
    img {
     max-width:100%;
     max-height:100%;
    }
  </style>
  </head>
  <body vocab="http://schema.org/">
    <div id="sidebar">
     <div class="title">
      <h1><a href="./index.html">Practicals: Data Mining</a></h1>
     </div>
     <div class="subtitle">
      <h3><a href="../../../../about.html">John Samuel</a></h3>
     </div>
    </div>
    <div class="licence"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="./../../../../../images/license.png"/></a>
    </div>
    <div class="page">
      <div class="home">
       <ul typeof="BreadcrumbList">
        <li property="itemListElement" typeof="ListItem">
          <a property="item" typeof="WebPage" href="../../../../index.html">
            <span property="name">Home</span>
          </a>
        </li>
        <li property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="index.html">
          <span property="name">Data Mining</span>
         </a>
        </li>
        <li property="itemListElement" typeof="ListItem">
         <a property="item" typeof="WebPage" href="../../../index.html">
          <span property="name">Teaching</span>
         </a>
        </li>
       </ul>
      </div>
      <div class="content">
        <h3>Goals</h3>
        <ul>
          <li>Work on <a href="https://en.wikipedia.org/wiki/Online_machine_learning">online machine training</a>.</li>
          <li>Work on <a href="http://scikit-learn.org/stable/modules/neural_networks_supervised.html">neural network models</a> using <a href="https://www.tensorflow.org/">Tensorflow</a>.</li>
          <li>Finish work on the <a href="https://en.wikipedia.org/wiki/Recommender_system">recommender system</a> and writing of project report.</li>
        </ul>
        <h3>Scoring</h3>
        <p>Every exercise has an associated difficulty level. Easy and medium-difficult exercises help you understand the fundamentals and give you ideas to work on difficult exercises. It is highly recommended that you finish easy and medium-difficult exercises to have a good score. Given below is the difficulty scale that will be marked with every exercise: </p>
        <ol>
          <li><span style="color:red">&#9733;</span>: Easy</li>
          <li><span style="color:red">&#9733;&#9733;</span>: Medium</li>
          <li><span style="color:red">&#9733;&#9733;&#9733;</span>: Difficult</li>
        </ol>
        <h3>Guidelines</h3>
        <ol>
          <li>To get complete guidance from the mentors, it is highly recommended that you work on today's practical session and not on the preceding ones.</li>
          <li>Make sure that you rename your submissions properly and correctly. Double-check your submissions.</li>
          <li>Please check the <a href="./references.html">references</a>.</li>
          <li>There are several ways to achieve a task. Hence there are many possible solutions. But try to make maximum use of the libraries that have been suggested to you for your exercises.</li>
        </ol>
        <h4>Installation</h4>
        <div class="exercise">
          <p>Please refer <a href="./installation.html">installation</a> page.</p>
        </div>
        <h4>Exercise 4.1 <span style="color:red">&#9733;</span></h4>
        <div class="exercise">
          <p>During our last <a href="./practicals3.html">practical session 3</a>, we split our data into two: training data and test data for creating models for prediction and we fed the complete training data to our classifier. However, in real life, we may have new data to train. Check the following code using perceptron and compare it with the code of exercise 3.3:</p>
          <p class="codeexample">
            <code>
              from sklearn import datasets, metrics</br>
              from sklearn.linear_model import Perceptron</br>
              import numpy as np</br>
              import matplotlib.pyplot as plot</br>
              </br>
              digits = datasets.load_digits()</br>
              training_size = int(digits.images.shape[0]/2)</br>
              </br>
              training_images = digits.images[0:training_size]</br>
              training_images = training_images.reshape((training_images.shape[0], -1))</br>
              </br>
              training_target = digits.target[0:training_size]</br>
              </br>
              classifier = Perceptron(max_iter=1000)</br>
              #training</br>
              for i in range(training_size):</br>
              &nbsp;&nbsp;&nbsp;&nbsp;training_data = np.array(training_images[i])</br>
              &nbsp;&nbsp;&nbsp;&nbsp;training_data = training_data.reshape(1, -1)</br>
              &nbsp;&nbsp;&nbsp;&nbsp;classifier.partial_fit(training_data, [training_target[i]], classes=np.unique(digits.target))</br>
              </br>
              #prediction</br>
              predict_images = digits.images[training_size+1:]</br>
              actual_labels = digits.target[training_size+1:]</br>
              predicted_labels = classifier.predict(predict_images.reshape((predict_images.shape[0], -1)))</br>
              </br>
              #classification report</br>
              print(metrics.classification_report(actual_labels,predicted_labels))</br>
            </code>
          </p>
          <p>This approach is called <a href="https://en.wikipedia.org/wiki/Online_machine_learning">online machine training</a> (or <a href="https://fr.wikipedia.org/wiki/Algorithme_d%27apprentissage_incr%C3%A9mental">algorithme d'apprentissage incr√©mental (fr)</a>). Did you get good precision? </p>
           <p>Your next question is to modify the above program and test online training with <b>MLPClassifier</b>.</p>
           <p>Try modifying (reducing and increasing) the training data size. What are your observations?</p>
        </div>
        <h4>Exercise 4.2 <span style="color:red">&#9733;&#9733;</span></h4>
        <div class="exercise">
         <p>Your final exercise is to use <a href="https://www.tensorflow.org/">Tensorflow</a>. We will use a Deep Neural Network (DNN) classifier with two hidden layers. Before starting, please refer the <a href="./installation.html">installation</a> page for installing tensorflow.</p>
         <p>Recall that we have already used Multilayer perceptron (MLP) which is a subset of Deep Neural Network in our preceding practical session. We will predict an image.</p>
         <p class="codeexample">
          <code>
              import tensorflow as tf</br>
              from sklearn import datasets</br>
              import matplotlib.pyplot as plot</br>
              &nbsp;&nbsp;&nbsp;&nbsp;</br>
              digits = datasets.load_digits()</br>
              training_size = int(digits.images.shape[0]/2)</br>
              </br>
              training_images = digits.images[0:training_size]</br>
              training_images = training_images.reshape((training_images.shape[0], -1))</br>
              </br>
              training_target = digits.target[0:training_size]</br>
              print(tf.contrib.layers.real_valued_column("", dimension=8))</br>
              </br>
              classifier = tf.contrib.learn.DNNClassifier(</br>
              &nbsp;&nbsp;&nbsp;&nbsp;    feature_columns=[tf.contrib.layers.real_valued_column("", dtype=tf.float64)],</br>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 2  hidden layers of 50 nodes each</br>
              &nbsp;&nbsp;&nbsp;&nbsp;    hidden_units=[50, 50],</br>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 10 classes: 0, 1, 2.....3</br>
              &nbsp;&nbsp;&nbsp;&nbsp;     n_classes=10)</br>
              </br>
              #training</br>
              classifier.fit(training_images, training_target, steps=100)</br>
              </br>
              #prediction</br>
              predict_images = digits.images[training_size+1:]</br>
              </br>
              predict = classifier.predict(predict_images[16].reshape(1,-1))</br>
              print(list(predict))</br>
              plot.imshow(predict_images[16], cmap=plot.cm.gray_r)</br>
              plot.show()</br>
          </code>
         </p>
         <p>Did it work? Let's now try to get the accuracy of our model.</p>
         <p class="codeexample">
          <code>
              import tensorflow as tf</br>
              from sklearn import datasets</br>
              import matplotlib.pyplot as plot</br>
              &nbsp;&nbsp;&nbsp;&nbsp;</br>
              digits = datasets.load_digits()</br>
              training_size = int(digits.images.shape[0]/2)</br>
              </br>
              training_images = digits.images[0:training_size]</br>
              training_images = training_images.reshape((training_images.shape[0], -1))</br>
              </br>
              training_target = digits.target[0:training_size]</br>
              print(tf.contrib.layers.real_valued_column("", dimension=8))</br>
              </br>
              classifier = tf.contrib.learn.DNNClassifier(</br>
              &nbsp;&nbsp;&nbsp;&nbsp;    feature_columns=[tf.contrib.layers.real_valued_column("", dtype=tf.float64)],</br>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 2  hidden layers of 50 nodes each</br>
              &nbsp;&nbsp;&nbsp;&nbsp;    hidden_units=[50, 50],</br>
              &nbsp;&nbsp;&nbsp;&nbsp;    # 10 classes: 0, 1, 2.....3</br>
              &nbsp;&nbsp;&nbsp;&nbsp;     n_classes=10)</br>
              </br>
              #training</br>
              classifier.fit(training_images, training_target, steps=100)</br>
              </br>
              #prediction</br>
              predict_images = digits.images[training_size+1:]</br>
              actual_labels = digits.target[training_size+1:]</br>
              evaluation = classifier.evaluate(x=predict_images.reshape((predict_images.shape[0], -1)), y=actual_labels)</br>
              print(evaluation['accuracy'])</br>
          </code>
         </p>
         <p>What's the accuracy that you got? Now change the number of neurons in each layer (currently it's set to 50 each). Also try to increase the number of hidden layers. Did your accuracy improve?</p>
        </div>
        <h4>Exercise 4.3 <span style="color:red">&#9733;&#9733;&#9733;</span></h4>
        <div class="exercise">
         <h5>Project: Image recommender system: 3 practical sessions</h5>
         <p>Recall that the goal of this project is to recommend images based on the color preferences of the user.</p>
         <p>Please prepare a 3-page Project report (French or English) detailing the following: </p>
         <ul>
          <li>Goal of your project</li>
          <li>Data sources of your training images and licence. Did you use labeled data sources? Did you ask your user to label images?</li>
          <li>Learning models that you tested and used and their precision.</li>
          <li>Size of your training data and test data.</li>
          <li>Did you use online machine learning?</li>
          <li>Information that you decided to store for each image.</li>
          <li>Information concerning user preferences</li>
          <li>Self-evaluation of your work.</li>
          <li>Remarks concering the practical sessions, exercises and scope for improvement.</li>
          <li>Conclusion</li>
         </ul>
         <p>Please do not add any program in this report.</p>
        </div>
        <h4>Submission</h4>
        <ul>
          <li>Rename your notebook as Name1_Name2_[Name3].ipynb, where Name1, Name2 are your names.</li>
          <li>Submit your <b>notebook and Project report</b> online.</li>
          <li>Please <b>do not</b> submit your images, JSON, TSV and CSV files.</li>
        </ul>
        <h4>References</h4>
        <p><a href="./references.html">Link</a></p>
      </div>
  </body>
</html>
